<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Behavioural genetics analysis of social isolation: Cholesky decomposition</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { font-weight: bold; } /* Alert */
code span.an { font-style: italic; } /* Annotation */
code span.cf { font-weight: bold; } /* ControlFlow */
code span.co { font-style: italic; } /* Comment */
code span.cv { font-style: italic; } /* CommentVar */
code span.do { font-style: italic; } /* Documentation */
code span.dt { text-decoration: underline; } /* DataType */
code span.er { font-weight: bold; } /* Error */
code span.in { font-style: italic; } /* Information */
code span.kw { font-weight: bold; } /* Keyword */
code span.pp { font-weight: bold; } /* Preprocessor */
code span.wa { font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/knthompson26/social-isolation-ADHD-bidirectional-effects">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Behavioural genetics analysis of social isolation: Cholesky decomposition</h1>

</div>


<p><strong>This is using the total score for social isolation (mother and teacher report combined). We will need to think about if this should be done for mother and teacher report separately.</strong></p>
<div id="data-prep" class="section level1">
<h1>Data prep</h1>
<div id="column-names" class="section level2">
<h2>Column names</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat.raw <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>         atwinid,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>         btwinid,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>         familyid,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>         rorderp5,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>         torder,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>         zygosity,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>         sampsex,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>         seswq35,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>         sethnic,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>         sisoe5,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>         sisoe7,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>         sisoe10,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>         sisoe12,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>         sisoy5,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>         sisoy7,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>         sisoy10,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>         sisoy12</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat)</span></code></pre></div>
<pre><code> [1] &quot;atwinid&quot;  &quot;btwinid&quot;  &quot;familyid&quot; &quot;rorderp5&quot; &quot;torder&quot;   &quot;zygosity&quot;
 [7] &quot;sampsex&quot;  &quot;seswq35&quot;  &quot;sethnic&quot;  &quot;sisoe5&quot;   &quot;sisoe7&quot;   &quot;sisoe10&quot; 
[13] &quot;sisoe12&quot;  &quot;sisoy5&quot;   &quot;sisoy7&quot;   &quot;sisoy10&quot;  &quot;sisoy12&quot; </code></pre>
</div>
<div id="recode-variables-into-factors" class="section level2 tabset tabset-fade">
<h2 class="tabset tabset-fade">Recode variables into factors</h2>
<div id="sex" class="section level3">
<h3>Sex</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex =</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">recode_factor</span>(<span class="fu">as_factor</span>(sampsex),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Male&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>sex)</span></code></pre></div>
<pre><code>
  Male Female 
  1092   1140 </code></pre>
</div>
<div id="ses" class="section level3">
<h3>SES</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ses =</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">recode_factor</span>(<span class="fu">as_factor</span>(seswq35),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Low&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Middle&quot;</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;High&quot;</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>ses)</span></code></pre></div>
<pre><code>
   Low Middle   High 
   742    738    752 </code></pre>
</div>
<div id="zygosity" class="section level3">
<h3>Zygosity</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">zygosity =</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">recode_factor</span>(<span class="fu">as_factor</span>(zygosity),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;MZ&quot;</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;DZ&quot;</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>zygosity)</span></code></pre></div>
<pre><code>
  MZ   DZ 
1242  990 </code></pre>
</div>
<div id="ethnicity" class="section level3">
<h3>Ethnicity</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ethnicity =</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">recode_factor</span>(<span class="fu">as_factor</span>(sethnic),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;White&quot;</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Asian&quot;</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;3&quot;</span> <span class="ot">=</span> <span class="st">&quot;Black&quot;</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;4&quot;</span> <span class="ot">=</span> <span class="st">&quot;Mixed race&quot;</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;5&quot;</span> <span class="ot">=</span> <span class="st">&quot;Other&quot;</span>))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(dat<span class="sc">$</span>ethnicity)</span></code></pre></div>
<pre><code>
     White      Asian      Black Mixed race      Other    Missing 
      2018         90         42          8         74          0 </code></pre>
</div>
</div>
<div id="convert-variables-to-numeric" class="section level2">
<h2>Convert variables to numeric</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sisoe5 =</span> <span class="fu">as.numeric</span>(sisoe5),      <span class="co"># isolation elder</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sisoe7 =</span> <span class="fu">as.numeric</span>(sisoe7),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">sisoe10 =</span> <span class="fu">as.numeric</span>(sisoe10),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sisoe12 =</span> <span class="fu">as.numeric</span>(sisoe12),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sisoy5 =</span> <span class="fu">as.numeric</span>(sisoy5),      <span class="co"># isolation younger</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sisoy7 =</span> <span class="fu">as.numeric</span>(sisoy7),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sisoy10 =</span> <span class="fu">as.numeric</span>(sisoy10),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sisoy12 =</span> <span class="fu">as.numeric</span>(sisoy12)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="creating-the-twin-dataset" class="section level2">
<h2>Creating the twin dataset</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span><span class="fu">c</span>(sampsex, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>         seswq35)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>         )</span></code></pre></div>
<p>To remove the double entry in the data, we will remove everyone who has a “random twin order” variable of 0. This will then remove any birth order effects.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dat.twin <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(rorderp5 <span class="sc">==</span> <span class="st">&quot;1&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># with all data to check numbers</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dat.MZ <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(zygosity <span class="sc">==</span> <span class="st">&quot;MZ&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>dat.DZ <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span> (zygosity <span class="sc">==</span> <span class="st">&quot;DZ&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># twin layout</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>dat.twin.MZ <span class="ot">&lt;-</span> dat.twin <span class="sc">%&gt;%</span> <span class="fu">filter</span>(zygosity <span class="sc">==</span> <span class="st">&quot;MZ&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>dat.twin.DZ <span class="ot">&lt;-</span> dat.twin <span class="sc">%&gt;%</span> <span class="fu">filter</span> (zygosity <span class="sc">==</span> <span class="st">&quot;DZ&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>MZ_summary <span class="ot">&lt;-</span> <span class="fu">describe</span>(dat.twin.MZ, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">skew =</span> <span class="cn">FALSE</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">range =</span> <span class="cn">FALSE</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>MZ_summary</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["vars"],"name":[1],"type":["int"],"align":["right"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["se"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"621","3":"7.672082e+04","4":"3.891705e+04","5":"1.561688e+03","_rn_":"atwinid"},{"1":"2","2":"621","3":"7.672083e+04","4":"3.891708e+04","5":"1.561689e+03","_rn_":"btwinid"},{"1":"3","2":"621","3":"7.671932e+03","4":"3.891707e+03","5":"1.561688e+02","_rn_":"familyid"},{"1":"4","2":"621","3":"1.000000e+00","4":"0.000000e+00","5":"0.000000e+00","_rn_":"rorderp5"},{"1":"5","2":"621","3":"1.492754e+00","4":"5.003505e-01","5":"2.007837e-02","_rn_":"torder"},{"1":"6","2":"621","3":"1.000000e+00","4":"0.000000e+00","5":"0.000000e+00","_rn_":"zygosity*"},{"1":"7","2":"621","3":"1.223833e+00","4":"8.010953e-01","5":"3.214685e-02","_rn_":"sethnic"},{"1":"8","2":"621","3":"7.662641e-01","4":"1.156995e+00","5":"4.642862e-02","_rn_":"sisoe5"},{"1":"9","2":"606","3":"7.886139e-01","4":"1.092311e+00","5":"4.437209e-02","_rn_":"sisoe7"},{"1":"10","2":"592","3":"9.253378e-01","4":"1.297948e+00","5":"5.334535e-02","_rn_":"sisoe10"},{"1":"11","2":"596","3":"8.795302e-01","4":"1.329823e+00","5":"5.447167e-02","_rn_":"sisoe12"},{"1":"12","2":"621","3":"6.958937e-01","4":"9.609572e-01","5":"3.856188e-02","_rn_":"sisoy5"},{"1":"13","2":"606","3":"6.844884e-01","4":"1.006487e+00","5":"4.088572e-02","_rn_":"sisoy7"},{"1":"14","2":"592","3":"8.074324e-01","4":"1.122292e+00","5":"4.612590e-02","_rn_":"sisoy10"},{"1":"15","2":"595","3":"8.273109e-01","4":"1.307630e+00","5":"5.360761e-02","_rn_":"sisoy12"},{"1":"16","2":"621","3":"1.520129e+00","4":"4.999974e-01","5":"2.006420e-02","_rn_":"sex*"},{"1":"17","2":"621","3":"1.980676e+00","4":"8.109812e-01","5":"3.254355e-02","_rn_":"ses*"},{"1":"18","2":"621","3":"1.223833e+00","4":"8.010953e-01","5":"3.214685e-02","_rn_":"ethnicity*"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>DZ_summary <span class="ot">&lt;-</span> <span class="fu">describe</span>(dat.twin.DZ, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">skew =</span> <span class="cn">FALSE</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">range =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>DZ_summary</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["vars"],"name":[1],"type":["int"],"align":["right"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["se"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"495","3":"7.594116e+04","4":"3.856557e+04","5":"1.733393e+03","_rn_":"atwinid"},{"1":"2","2":"495","3":"7.594116e+04","4":"3.856554e+04","5":"1.733392e+03","_rn_":"btwinid"},{"1":"3","2":"495","3":"7.593966e+03","4":"3.856555e+03","5":"1.733393e+02","_rn_":"familyid"},{"1":"4","2":"495","3":"1.000000e+00","4":"0.000000e+00","5":"0.000000e+00","_rn_":"rorderp5"},{"1":"5","2":"495","3":"1.509091e+00","4":"5.004231e-01","5":"2.249234e-02","_rn_":"torder"},{"1":"6","2":"495","3":"2.000000e+00","4":"0.000000e+00","5":"0.000000e+00","_rn_":"zygosity*"},{"1":"7","2":"495","3":"1.218182e+00","4":"7.850274e-01","5":"3.528436e-02","_rn_":"sethnic"},{"1":"8","2":"495","3":"8.961616e-01","4":"1.163360e+00","5":"5.228914e-02","_rn_":"sisoe5"},{"1":"9","2":"483","3":"9.913043e-01","4":"1.431321e+00","5":"6.512735e-02","_rn_":"sisoe7"},{"1":"10","2":"477","3":"1.110692e+00","4":"1.480529e+00","5":"6.778875e-02","_rn_":"sisoe10"},{"1":"11","2":"477","3":"1.110377e+00","4":"1.504602e+00","5":"6.889097e-02","_rn_":"sisoe12"},{"1":"12","2":"495","3":"9.355556e-01","4":"1.254041e+00","5":"5.636497e-02","_rn_":"sisoy5"},{"1":"13","2":"483","3":"9.004141e-01","4":"1.171072e+00","5":"5.328564e-02","_rn_":"sisoy7"},{"1":"14","2":"477","3":"9.494759e-01","4":"1.294488e+00","5":"5.927052e-02","_rn_":"sisoy10"},{"1":"15","2":"477","3":"9.970650e-01","4":"1.353688e+00","5":"6.198110e-02","_rn_":"sisoy12"},{"1":"16","2":"495","3":"1.498990e+00","4":"5.005048e-01","5":"2.249602e-02","_rn_":"sex*"},{"1":"17","2":"495","3":"2.034343e+00","4":"8.276793e-01","5":"3.720142e-02","_rn_":"ses*"},{"1":"18","2":"495","3":"1.218182e+00","4":"7.850274e-01","5":"3.528436e-02","_rn_":"ethnicity*"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="mz-and-dz-phenotypic-correlation-matrices" class="section level1">
<h1>MZ and DZ phenotypic correlation matrices</h1>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>selvars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sisoe5&quot;</span>, <span class="st">&quot;sisoe7&quot;</span>, <span class="st">&quot;sisoe10&quot;</span>, <span class="st">&quot;sisoe12&quot;</span>, <span class="st">&quot;sisoy5&quot;</span>, <span class="st">&quot;sisoy7&quot;</span>, <span class="st">&quot;sisoy10&quot;</span>, <span class="st">&quot;sisoy12&quot;</span>)</span></code></pre></div>
<p>Need to check the within-twin MZ and DZ phenotypic correlations (rmz, rdz) of each phenotype (correlations between elder and younger twin for each phenotype)</p>
<p>The rule of thumb is:</p>
<ul>
<li>if 2*rdz&gt;rmz, choose an ACE model;</li>
<li>if 2*rdz&lt;rmz, choose a ADE model</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariance matrix</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>covar.mz <span class="ot">&lt;-</span> <span class="fu">cov</span>(dat.twin.MZ[, selvars], <span class="at">use =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation matrix (standardized covariance)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>cor.mz <span class="ot">&lt;-</span> <span class="fu">cor</span>(dat.twin.MZ[, selvars], <span class="at">use =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cor.mz, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>        sisoe5 sisoe7 sisoe10 sisoe12 sisoy5 sisoy7 sisoy10 sisoy12
sisoe5   1.000  0.485   0.327   0.247  0.585  0.354   0.294   0.299
sisoe7   0.485  1.000   0.438   0.351  0.299  0.444   0.252   0.251
sisoe10  0.327  0.438   1.000   0.537  0.247  0.387   0.453   0.394
sisoe12  0.247  0.351   0.537   1.000  0.212  0.283   0.343   0.453
sisoy5   0.585  0.299   0.247   0.212  1.000  0.554   0.368   0.357
sisoy7   0.354  0.444   0.387   0.283  0.554  1.000   0.438   0.413
sisoy10  0.294  0.252   0.453   0.343  0.368  0.438   1.000   0.532
sisoy12  0.299  0.251   0.394   0.453  0.357  0.413   0.532   1.000</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariance matrix</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>covar.dz <span class="ot">&lt;-</span> <span class="fu">cov</span>(dat.twin.DZ[, selvars], <span class="at">use =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation matrix (standardized covariance)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>cor.dz <span class="ot">&lt;-</span> <span class="fu">cor</span>(dat.twin.DZ[, selvars], <span class="at">use =</span> <span class="st">&quot;complete&quot;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(cor.dz, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>        sisoe5 sisoe7 sisoe10 sisoe12 sisoy5 sisoy7 sisoy10 sisoy12
sisoe5   1.000  0.547   0.426   0.397  0.059  0.125   0.095   0.145
sisoe7   0.547  1.000   0.579   0.468  0.042  0.165   0.118   0.096
sisoe10  0.426  0.579   1.000   0.650  0.040  0.103   0.174   0.149
sisoe12  0.397  0.468   0.650   1.000 -0.032  0.077   0.078   0.110
sisoy5   0.059  0.042   0.040  -0.032  1.000  0.431   0.351   0.300
sisoy7   0.125  0.165   0.103   0.077  0.431  1.000   0.468   0.364
sisoy10  0.095  0.118   0.174   0.078  0.351  0.468   1.000   0.565
sisoy12  0.145  0.096   0.149   0.110  0.300  0.364   0.565   1.000</code></pre>
<p>Social isolation age 5:</p>
<ul>
<li>rMZ = 0.585</li>
<li>rDZ = 0.056 <em>seems low?</em></li>
<li>2*rDZ = 0.112</li>
<li>0.112&lt;0.585 = ADE<em>?</em></li>
</ul>
<p>Social isolation age 7:</p>
<ul>
<li>rMZ = 0.444</li>
<li>rDZ = 0.159</li>
<li>2*rDZ = 0.318</li>
<li>0.318&lt;0.444 = ADE<em>?</em></li>
</ul>
<p>Social isolation age 10:</p>
<ul>
<li>rMZ = 0.453</li>
<li>rDZ = 0.174</li>
<li>2*rDZ = 0.348</li>
<li>0.348&lt;0.453 = ADE<em>?</em></li>
</ul>
<p>Social isolation age 12:</p>
<ul>
<li>rMZ = 0.453</li>
<li>rDZ = 0.110</li>
<li>2*rDZ = 0.220</li>
<li>0.220&lt;0.453 = ADE<em>?</em></li>
</ul>
<p><strong>As the MZ correlations are relatively low for a dominance effect, it suggests here that an AE would be the way to go - so that A captures all additive and dominant genetic effects.</strong></p>
<p>Using Falconer’s equations, we can obtain preliminary estimates of the standardized A, C, E variance components.</p>
<p>VA = 2*rmz-rdz VC = 1-VA+VE VE= 1-rmz</p>
<p>VA = 2*0.59-0.056 = 1.068 VC = 1- 1.068 + 0.41 = -0.4789 VE = 1 - 0.59 = 0.41</p>
<p>As C is negative here, it’s likely that the OpenMX model will give a very small estimate for C and that C will be dropped from the ACE model. The power to detect C is very low, to detect a C2 of 10% with a h2 of 60% requires 2200 MZ and DZ pairs. However, when deciding on an AE model, any C that does exist will fall into A and you will get an inflated heritability estimate.</p>
<hr />
<p>Below is not needed for analyses - but showing another way to get matrices.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variances from covariance matrix - diagonal is one variable with itself</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>var.mz <span class="ot">&lt;-</span> <span class="fu">diag</span>(covar.mz) </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># creating the standard deviation into a vector (sd is the square root of the variance) then put this into a matrix</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>sd.mz <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">sqrt</span>(var.mz))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># re-calculating variance of MZ </span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>Smz <span class="ot">&lt;-</span> sd.mz<span class="sc">%*%</span>cor.mz<span class="sc">%*%</span><span class="fu">t</span>(sd.mz) </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(covar.mz <span class="sc">-</span> Smz, <span class="dv">3</span>) <span class="co"># compare with previous calculation</span></span></code></pre></div>
<pre><code>        sisoe5 sisoe7 sisoe10 sisoe12 sisoy5 sisoy7 sisoy10 sisoy12
sisoe5       0      0       0       0      0      0       0       0
sisoe7       0      0       0       0      0      0       0       0
sisoe10      0      0       0       0      0      0       0       0
sisoe12      0      0       0       0      0      0       0       0
sisoy5       0      0       0       0      0      0       0       0
sisoy7       0      0       0       0      0      0       0       0
sisoy10      0      0       0       0      0      0       0       0
sisoy12      0      0       0       0      0      0       0       0</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Therefore, we can also obtain the correlation matrix as follows</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>rMZ <span class="ot">&lt;-</span> <span class="fu">cov2cor</span>(covar.mz)</span></code></pre></div>
<hr />
</div>
<div id="cholesky-fitting" class="section level1">
<h1>Cholesky fitting</h1>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>nv  <span class="ot">&lt;-</span> <span class="dv">4</span>            <span class="co"># number of variables for a twin </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ntv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>nv     <span class="co"># number of variables for a pair </span></span></code></pre></div>
<div id="saturated-model" class="section level2">
<h2>Saturated model</h2>
<div id="parameter-labels" class="section level4">
<h4>Parameter labels</h4>
<p><strong>Labels for variables:</strong></p>
<p>The correlations should reflect all in the matrix that are not 1 and below/above the diagonal, an example of the labeling is below:</p>
<pre><code>  xph   = cross phenotype/variable/trait
  xt    = cross twin
  xtxph = cross twin cross phenotype</code></pre>
<p>2x2 matrix: sisoe5 sisoe7 sisoy5 sisoy7 sisoe5 1.000<br />
sisoe7 xph1 1.000<br />
sisoy5 xt1 xtxph2 1.000<br />
sisoy7 xtxph1 xt2 xph2 1.000</p>
<p>Full 4x4 correlation matrix: sisoe5 sisoe7 sisoe10 sisoe12 sisoy5 sisoy7 sisoy10 sisoy12 sisoe5 1.000<br />
sisoe7 xph1 1.000<br />
sisoe10 xph2 xph4 1.000<br />
sisoe12 xph3 xph5 xph6 1.000 sisoy5 xt1 xtxph4 xtxph7 xtxph10 1.000<br />
sisoy7 xtxph1 xt2 xtxph8 xtxph11 xph7 1.000<br />
sisoy10 xtxph2 xtxph5 xt3 xtxph12 xph8 xph10 1.000<br />
sisoy12 xtxph3 xtxph6 xtxph9 xt4 xph9 xph11 xph12 1.000</p>
<p>First we need to specify the start values and labels to make the code less busy. For the start values, I used the summary tables to check the approximate value the model should be looking for. The list should reflect the same order that you have in selvars.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># start values</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>svM   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>, <span class="fl">0.7</span>)    <span class="co"># means               </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>svSD  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>, <span class="fl">1.1</span>)    <span class="co"># standard deviations</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>svRmz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.3</span>, <span class="dv">28</span>))                    <span class="co"># correlations for MZ - 28 correlations in total</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>svRdz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.15</span>, <span class="dv">28</span>))                   <span class="co"># correlations for DZ </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># labels</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>labMZm  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MZme5&quot;</span>, <span class="st">&quot;MZme7&quot;</span>, <span class="st">&quot;MZme10&quot;</span>, <span class="st">&quot;MZme12&quot;</span>, <span class="st">&quot;MZmy5&quot;</span>, <span class="st">&quot;MZmy7&quot;</span>, <span class="st">&quot;MZmy10&quot;</span>, <span class="st">&quot;MZmy12&quot;</span>)             <span class="co"># MZ means       </span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>labDZm  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DZme5&quot;</span>, <span class="st">&quot;DZme7&quot;</span>, <span class="st">&quot;DZme10&quot;</span>, <span class="st">&quot;DZme12&quot;</span>, <span class="st">&quot;DZmy5&quot;</span>, <span class="st">&quot;DZmy7&quot;</span>, <span class="st">&quot;DZmy10&quot;</span>, <span class="st">&quot;DZmy12&quot;</span>)           <span class="co"># DZ means</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>labMZsd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MZsde5&quot;</span>, <span class="st">&quot;MZsde7&quot;</span>, <span class="st">&quot;MZsde10&quot;</span>, <span class="st">&quot;MZsde12&quot;</span>, <span class="st">&quot;MZsdy5&quot;</span>, <span class="st">&quot;MZsdy7&quot;</span>, <span class="st">&quot;MZsdy10&quot;</span>, <span class="st">&quot;MZsdy12&quot;</span>)   <span class="co"># MZ standard deviations</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>labDZsd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DZsde5&quot;</span>, <span class="st">&quot;DZsde7&quot;</span>, <span class="st">&quot;DZsde10&quot;</span>, <span class="st">&quot;DZsde12&quot;</span>, <span class="st">&quot;DZsdy5&quot;</span>, <span class="st">&quot;DZsdy7&quot;</span>, <span class="st">&quot;DZsdy10&quot;</span>, <span class="st">&quot;DZsdy12&quot;</span>)   <span class="co"># DZ standard deviations</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>labMZr  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MZrxph1&quot;</span>, <span class="st">&quot;MZrxph2&quot;</span>, <span class="st">&quot;MZrxph3&quot;</span>, <span class="st">&quot;MZrxt1&quot;</span>, <span class="st">&quot;MZrxtxph1&quot;</span>, <span class="st">&quot;MZrxtxph2&quot;</span>, <span class="st">&quot;MZrxtxph3&quot;</span>,     <span class="co"># MZ correlations</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;MZrxph4&quot;</span>, <span class="st">&quot;MZrxph5&quot;</span>, <span class="st">&quot;MZrxtxph4&quot;</span>, <span class="st">&quot;MZrxt2&quot;</span>, <span class="st">&quot;MZrxtxph5&quot;</span>, <span class="st">&quot;MZrxtxph6&quot;</span>, </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;MZrxph6&quot;</span>, <span class="st">&quot;MZrxtxph7&quot;</span>, <span class="st">&quot;MZrxtxph8&quot;</span>, <span class="st">&quot;MZrxt3&quot;</span>, <span class="st">&quot;MZrxtxph9&quot;</span>,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;MZrxtxph10&quot;</span>, <span class="st">&quot;MZrxtxph11&quot;</span>, <span class="st">&quot;MZrxtxph12&quot;</span>, <span class="st">&quot;MZrxt4&quot;</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;MZrxph7&quot;</span>, <span class="st">&quot;MZrxph8&quot;</span>, <span class="st">&quot;MZrxph9&quot;</span>, </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;MZrxph10&quot;</span>, <span class="st">&quot;MZrxph11&quot;</span>,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;MZrxph12&quot;</span>)     </span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>labDZr  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DZrxph1&quot;</span>, <span class="st">&quot;DZrxph2&quot;</span>, <span class="st">&quot;DZrxph3&quot;</span>, <span class="st">&quot;DZrxt1&quot;</span>, <span class="st">&quot;DZrxtxph1&quot;</span>, <span class="st">&quot;DZrxtxph2&quot;</span>, <span class="st">&quot;DZrxtxph3&quot;</span>,     <span class="co"># DZ correlations</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DZrxph4&quot;</span>, <span class="st">&quot;DZrxph5&quot;</span>, <span class="st">&quot;DZrxtxph4&quot;</span>, <span class="st">&quot;DZrxt2&quot;</span>, <span class="st">&quot;DZrxtxph5&quot;</span>, <span class="st">&quot;DZrxtxph6&quot;</span>, </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DZrxph6&quot;</span>, <span class="st">&quot;DZrxtxph7&quot;</span>, <span class="st">&quot;DZrxtxph8&quot;</span>, <span class="st">&quot;DZrxt3&quot;</span>, <span class="st">&quot;DZrxtxph9&quot;</span>,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DZrxtxph10&quot;</span>, <span class="st">&quot;DZrxtxph11&quot;</span>, <span class="st">&quot;DZrxtxph12&quot;</span>, <span class="st">&quot;DZrxt4&quot;</span>,</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DZrxph7&quot;</span>, <span class="st">&quot;DZrxph8&quot;</span>, <span class="st">&quot;DZrxph9&quot;</span>, </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DZrxph10&quot;</span>, <span class="st">&quot;DZrxph11&quot;</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DZrxph12&quot;</span>) </span></code></pre></div>
</div>
<div id="matrices" class="section level4">
<h4>Matrices</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MZ</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>meanMZ  <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Full&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> ntv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> labMZm, <span class="at">name =</span> <span class="st">&quot;ExpMeanMZ&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>sdMZ        <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Diag&quot;</span>, <span class="at">nrow =</span> ntv, <span class="at">ncol =</span> ntv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svSD,  <span class="at">labels =</span> labMZsd, <span class="at">name =</span> <span class="st">&quot;sdMZ&quot;</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>corMZ       <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Stand&quot;</span>, <span class="at">nrow =</span> ntv, <span class="at">ncol =</span> ntv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svRmz, <span class="at">labels =</span> labMZr,   <span class="at">name =</span> <span class="st">&quot;corMZ&quot;</span>) </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># DZ</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>meanDZ  <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Full&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> ntv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> labDZm, <span class="at">name =</span> <span class="st">&quot;ExpMeanDZ&quot;</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>sdDZ        <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Diag&quot;</span>, <span class="at">nrow =</span> ntv, <span class="at">ncol =</span> ntv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svSD,  <span class="at">labels =</span> labDZsd, <span class="at">name =</span> <span class="st">&quot;sdDZ&quot;</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>corDZ       <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Stand&quot;</span>, <span class="at">nrow =</span> ntv, <span class="at">ncol =</span> ntv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svRdz, <span class="at">labels =</span> labDZr,   <span class="at">name =</span> <span class="st">&quot;corDZ&quot;</span>) </span></code></pre></div>
</div>
<div id="alegbra" class="section level4">
<h4>Alegbra</h4>
<p>This is the same matrix algebra that is calculated above from the Boulder workshop code:</p>
<pre><code>        covariace = SD * r * t(SD) </code></pre>
<p>%*% is matrix multiplication t() is transpose full list of operators <a href="https://openmx.ssri.psu.edu/wiki/matrix-operators-and-functions">here</a></p>
<p>The result matrix of the matrix algebra calculation S<em>R</em>S’ is the Symmetric Variance-Covariance matrix of the model, with the expected Variance of the Twin 1 variable on the 1st Diagonal Element, the expected Variance of the Twin 2 variable on the 2nd Diagonal Element and the Covariance on the off-diagonal. Since we are dealing with two types of Twin pairs, we will specify a different S and R matrix for MZ and DZ pairs and fit a separate Saturated model to each of the sub-data files, the MZ data and the DZ data.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>covMZ   <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> sdMZ <span class="sc">%*%</span> corMZ <span class="sc">%*%</span> <span class="fu">t</span>(sdMZ), <span class="at">name =</span> <span class="st">&quot;ExpCovMZ&quot;</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>covDZ   <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> sdDZ <span class="sc">%*%</span> corDZ <span class="sc">%*%</span> <span class="fu">t</span>(sdDZ), <span class="at">name =</span> <span class="st">&quot;ExpCovDZ&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>datMZ <span class="ot">&lt;-</span> <span class="fu">mxData</span>(<span class="at">observed =</span> dat.twin.MZ, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>datDZ <span class="ot">&lt;-</span> <span class="fu">mxData</span>(<span class="at">observed =</span> dat.twin.DZ, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Objective objects </span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>objMZ <span class="ot">&lt;-</span> <span class="fu">mxExpectationNormal</span>(<span class="at">covariance =</span> <span class="st">&quot;ExpCovMZ&quot;</span>, <span class="at">means =</span> <span class="st">&quot;ExpMeanMZ&quot;</span>, <span class="at">dimnames =</span> selvars)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>objDZ <span class="ot">&lt;-</span> <span class="fu">mxExpectationNormal</span>(<span class="at">covariance =</span> <span class="st">&quot;ExpCovDZ&quot;</span>, <span class="at">means =</span> <span class="st">&quot;ExpMeanDZ&quot;</span>, <span class="at">dimnames =</span> selvars)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fitFunction <span class="ot">&lt;-</span> <span class="fu">mxFitFunctionML</span>()</span></code></pre></div>
</div>
<div id="create-the-saturated-model" class="section level4">
<h4>Create the saturated model</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># models for MZ and DZ</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>modelMZ <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(meanMZ, sdMZ, corMZ, covMZ, datMZ, objMZ, fitFunction, <span class="at">name =</span> <span class="st">&quot;MZ&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>modelDZ <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(meanDZ, sdDZ, corDZ, covDZ, datDZ, objDZ, fitFunction, <span class="at">name =</span> <span class="st">&quot;DZ&quot;</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># estimation</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>minus2ll <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> MZ.objective <span class="sc">+</span> DZ.objective, <span class="at">name =</span> <span class="st">&quot;m2LL&quot;</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">mxFitFunctionAlgebra</span>(<span class="st">&quot;m2LL&quot;</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Saturated model </span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>SatModel <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(<span class="st">&quot;Sat&quot;</span>, modelMZ, modelDZ, minus2ll, obj)</span></code></pre></div>
</div>
<div id="saturated-model-output" class="section level4">
<h4>Saturated model output</h4>
<p>The Saturated Model is represented by a path diagram. Using path tracing rules we will derive the expected model for the variance-covariance structure of the data. The goal of the saturated model is to obtain the best possible (maximum likelihood) estimation of the twin correlations and this is preferred over the correlations that you can typically get using R commands (also shown above).</p>
<p>The cross-twin correlations (rxt) are expected to be different, and the cross-twin cross-trait (rxtxph) are expected to be different. However, the within-twin cross trait (rxph) are not supposed to differ for the elder and younger twins.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the saturated model</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>SatFit  <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(SatModel, <span class="at">intervals =</span> <span class="cn">FALSE</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>(SatSumm    <span class="ot">&lt;-</span> <span class="fu">summary</span>(SatFit))</span></code></pre></div>
<pre><code>Summary of Sat 
 
free parameters:
         name       matrix row     col     Estimate  Std.Error A
1       MZme5 MZ.ExpMeanMZ   1  sisoe5  0.766264795 0.04638809  
2       MZme7 MZ.ExpMeanMZ   1  sisoe7  0.788673191 0.04420977  
3      MZme10 MZ.ExpMeanMZ   1 sisoe10  0.923596833 0.05286343  
4      MZme12 MZ.ExpMeanMZ   1 sisoe12  0.878391935 0.05412559  
5       MZmy5 MZ.ExpMeanMZ   1  sisoy5  0.695893812 0.03852844  
6       MZmy7 MZ.ExpMeanMZ   1  sisoy7  0.687117516 0.04073248  
7      MZmy10 MZ.ExpMeanMZ   1 sisoy10  0.811396645 0.04589466  
8      MZmy12 MZ.ExpMeanMZ   1 sisoy12  0.825344828 0.05320588  
9      MZsde5      MZ.sdMZ   1       1  1.156063398 0.03280288  
10     MZsde7      MZ.sdMZ   2       2  1.091781991 0.03135476  
11    MZsde10      MZ.sdMZ   3       3  1.294433336 0.03746034  
12    MZsde12      MZ.sdMZ   4       4  1.326338386 0.03828306  
13     MZsdy5      MZ.sdMZ   5       5  0.960183290 0.02724378  
14     MZsdy7      MZ.sdMZ   6       6  1.006730100 0.02891466  
15    MZsdy10      MZ.sdMZ   7       7  1.123471380 0.03267962  
16    MZsdy12      MZ.sdMZ   8       8  1.304462076 0.03768187  
17    MZrxph1     MZ.corMZ   1       2  0.475165362 0.03149680  
18    MZrxph2     MZ.corMZ   1       3  0.320576807 0.03681112  
19    MZrxph4     MZ.corMZ   2       3  0.430096744 0.03328192  
20    MZrxph3     MZ.corMZ   1       4  0.249485674 0.03845723  
21    MZrxph5     MZ.corMZ   2       4  0.347483455 0.03584243  
22    MZrxph6     MZ.corMZ   3       4  0.527348212 0.02960677  
23     MZrxt1     MZ.corMZ   1       5  0.579270090 0.02666357  
24  MZrxtxph4     MZ.corMZ   2       5  0.287291894 0.03733623  
25  MZrxtxph7     MZ.corMZ   3       5  0.233927607 0.03871212  
26 MZrxtxph10     MZ.corMZ   4       5  0.199584121 0.03894081  
27  MZrxtxph1     MZ.corMZ   1       6  0.340502272 0.03593749  
28     MZrxt2     MZ.corMZ   2       6  0.438606051 0.03285631  
29  MZrxtxph8     MZ.corMZ   3       6  0.380178076 0.03533315  
30 MZrxtxph11     MZ.corMZ   4       6  0.270120075 0.03808340  
31    MZrxph7     MZ.corMZ   5       6  0.535199509 0.02903081  
32  MZrxtxph2     MZ.corMZ   1       7  0.281462249 0.03780030  
33  MZrxtxph5     MZ.corMZ   2       7  0.246336822 0.03831630  
34     MZrxt3     MZ.corMZ   3       7  0.453977195 0.03262058  
35 MZrxtxph12     MZ.corMZ   4       7  0.331794424 0.03654413  
36    MZrxph8     MZ.corMZ   5       7  0.353281771 0.03589125  
37   MZrxph10     MZ.corMZ   6       7  0.436515681 0.03336009  
38  MZrxtxph3     MZ.corMZ   1       8  0.279150719 0.03778410  
39  MZrxtxph6     MZ.corMZ   2       8  0.234400791 0.03886400  
40  MZrxtxph9     MZ.corMZ   3       8  0.379996825 0.03546718  
41     MZrxt4     MZ.corMZ   4       8  0.427408662 0.03338735  
42    MZrxph9     MZ.corMZ   5       8  0.338018221 0.03595036  
43   MZrxph11     MZ.corMZ   6       8  0.418066166 0.03421032  
44   MZrxph12     MZ.corMZ   7       8  0.532536311 0.02979503  
45      DZme5 DZ.ExpMeanDZ   1  sisoe5  0.896161522 0.05223791  
46      DZme7 DZ.ExpMeanDZ   1  sisoe7  0.991774651 0.06469738  
47     DZme10 DZ.ExpMeanDZ   1 sisoe10  1.118334307 0.06701619  
48     DZme12 DZ.ExpMeanDZ   1 sisoe12  1.110563850 0.06843914  
49      DZmy5 DZ.ExpMeanDZ   1  sisoy5  0.935556396 0.05630833  
50      DZmy7 DZ.ExpMeanDZ   1  sisoy7  0.903257545 0.05307285  
51     DZmy10 DZ.ExpMeanDZ   1 sisoy10  0.945189665 0.05875289  
52     DZmy12 DZ.ExpMeanDZ   1 sisoy12  0.996286849 0.06187303  
53     DZsde5      DZ.sdDZ   1       1  1.162184232 0.03693726  
54     DZsde7      DZ.sdDZ   2       2  1.428730408 0.04583557  
55    DZsde10      DZ.sdDZ   3       3  1.474537574 0.04742857  
56    DZsde12      DZ.sdDZ   4       4  1.503710911 0.04860012  
57     DZsdy5      DZ.sdDZ   5       5  1.252774562 0.03981576  
58     DZsdy7      DZ.sdDZ   6       6  1.170262848 0.03763202  
59    DZsdy10      DZ.sdDZ   7       7  1.290465401 0.04159347  
60    DZsdy12      DZ.sdDZ   8       8  1.357391197 0.04412414  
61    DZrxph1     DZ.corDZ   1       2  0.534581616 0.03234885  
62    DZrxph2     DZ.corDZ   1       3  0.409217888 0.03777711  
63    DZrxph4     DZ.corDZ   2       3  0.579062591 0.03071981  
64    DZrxph3     DZ.corDZ   1       4  0.372909940 0.03905181  
65    DZrxph5     DZ.corDZ   2       4  0.468407293 0.03669841  
66    DZrxph6     DZ.corDZ   3       4  0.660462621 0.02585673  
67     DZrxt1     DZ.corDZ   1       5  0.056871593 0.04479988  
68  DZrxtxph4     DZ.corDZ   2       5  0.055624372 0.04524195  
69  DZrxtxph7     DZ.corDZ   3       5  0.053670638 0.04554953  
70 DZrxtxph10     DZ.corDZ   4       5 -0.009405021 0.04571680  
71  DZrxtxph1     DZ.corDZ   1       6  0.135596168 0.04428098  
72     DZrxt2     DZ.corDZ   2       6  0.198852591 0.04360335  
73  DZrxtxph8     DZ.corDZ   3       6  0.133270333 0.04507874  
74 DZrxtxph11     DZ.corDZ   4       6  0.109148612 0.04598103  
75    DZrxph7     DZ.corDZ   5       6  0.423353664 0.03738051  
76  DZrxtxph2     DZ.corDZ   1       7  0.108018822 0.04478140  
77  DZrxtxph5     DZ.corDZ   2       7  0.155460988 0.04447253  
78     DZrxt3     DZ.corDZ   3       7  0.190206381 0.04387623  
79 DZrxtxph12     DZ.corDZ   4       7  0.099239611 0.04550383  
80    DZrxph8     DZ.corDZ   5       7  0.349709466 0.04027653  
81   DZrxph10     DZ.corDZ   6       7  0.482963026 0.03500181  
82  DZrxtxph3     DZ.corDZ   1       8  0.152876346 0.04430422  
83  DZrxtxph6     DZ.corDZ   2       8  0.119699773 0.04541255  
84  DZrxtxph9     DZ.corDZ   3       8  0.165005788 0.04438085  
85     DZrxt4     DZ.corDZ   4       8  0.128940673 0.04501320  
86    DZrxph9     DZ.corDZ   5       8  0.300027273 0.04172784  
87   DZrxph11     DZ.corDZ   6       8  0.372262438 0.03952115  
88   DZrxph12     DZ.corDZ   7       8  0.569266657 0.03118713  

Model Statistics: 
               |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
       Model:             88                   8605              25456.57
   Saturated:             NA                     NA                    NA
Independence:             NA                     NA                    NA
Number of observations/statistics: 1116/8693

Information Criteria: 
      |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
AIC:       8246.569               25632.57                 25647.82
BIC:     -34929.072               26074.11                 25794.60
CFI: NA 
TLI: 1   (also known as NNFI) 
RMSEA:  0  [95% CI (NA, NA)]
Prob(RMSEA &lt;= 0.05): NA
To get additional fit indices, see help(mxRefModels)
timestamp: 2022-10-03 14:19:55 
Wall clock time: 2.218371 secs 
optimizer:  SLSQP 
OpenMx version number: 2.20.3 
Need help?  See help(mxSummary) </code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate SatModel Output so you could see the labels</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>SatFit<span class="sc">$</span>MZ.corMZ</span></code></pre></div>
<pre><code>StandMatrix &#39;corMZ&#39; 

$labels
     [,1]        [,2]        [,3]        [,4]         [,5]         [,6]        
[1,] NA          &quot;MZrxph1&quot;   &quot;MZrxph2&quot;   &quot;MZrxph3&quot;    &quot;MZrxt1&quot;     &quot;MZrxtxph1&quot; 
[2,] &quot;MZrxph1&quot;   NA          &quot;MZrxph4&quot;   &quot;MZrxph5&quot;    &quot;MZrxtxph4&quot;  &quot;MZrxt2&quot;    
[3,] &quot;MZrxph2&quot;   &quot;MZrxph4&quot;   NA          &quot;MZrxph6&quot;    &quot;MZrxtxph7&quot;  &quot;MZrxtxph8&quot; 
[4,] &quot;MZrxph3&quot;   &quot;MZrxph5&quot;   &quot;MZrxph6&quot;   NA           &quot;MZrxtxph10&quot; &quot;MZrxtxph11&quot;
[5,] &quot;MZrxt1&quot;    &quot;MZrxtxph4&quot; &quot;MZrxtxph7&quot; &quot;MZrxtxph10&quot; NA           &quot;MZrxph7&quot;   
[6,] &quot;MZrxtxph1&quot; &quot;MZrxt2&quot;    &quot;MZrxtxph8&quot; &quot;MZrxtxph11&quot; &quot;MZrxph7&quot;    NA          
[7,] &quot;MZrxtxph2&quot; &quot;MZrxtxph5&quot; &quot;MZrxt3&quot;    &quot;MZrxtxph12&quot; &quot;MZrxph8&quot;    &quot;MZrxph10&quot;  
[8,] &quot;MZrxtxph3&quot; &quot;MZrxtxph6&quot; &quot;MZrxtxph9&quot; &quot;MZrxt4&quot;     &quot;MZrxph9&quot;    &quot;MZrxph11&quot;  
     [,7]         [,8]       
[1,] &quot;MZrxtxph2&quot;  &quot;MZrxtxph3&quot;
[2,] &quot;MZrxtxph5&quot;  &quot;MZrxtxph6&quot;
[3,] &quot;MZrxt3&quot;     &quot;MZrxtxph9&quot;
[4,] &quot;MZrxtxph12&quot; &quot;MZrxt4&quot;   
[5,] &quot;MZrxph8&quot;    &quot;MZrxph9&quot;  
[6,] &quot;MZrxph10&quot;   &quot;MZrxph11&quot; 
[7,] NA           &quot;MZrxph12&quot; 
[8,] &quot;MZrxph12&quot;   NA         

$values
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 1.0000000 0.4751654 0.3205768 0.2494857 0.5792701 0.3405023 0.2814622
[2,] 0.4751654 1.0000000 0.4300967 0.3474835 0.2872919 0.4386061 0.2463368
[3,] 0.3205768 0.4300967 1.0000000 0.5273482 0.2339276 0.3801781 0.4539772
[4,] 0.2494857 0.3474835 0.5273482 1.0000000 0.1995841 0.2701201 0.3317944
[5,] 0.5792701 0.2872919 0.2339276 0.1995841 1.0000000 0.5351995 0.3532818
[6,] 0.3405023 0.4386061 0.3801781 0.2701201 0.5351995 1.0000000 0.4365157
[7,] 0.2814622 0.2463368 0.4539772 0.3317944 0.3532818 0.4365157 1.0000000
[8,] 0.2791507 0.2344008 0.3799968 0.4274087 0.3380182 0.4180662 0.5325363
          [,8]
[1,] 0.2791507
[2,] 0.2344008
[3,] 0.3799968
[4,] 0.4274087
[5,] 0.3380182
[6,] 0.4180662
[7,] 0.5325363
[8,] 1.0000000

$free
      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
[1,] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[2,]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[3,]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
[4,]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
[5,]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
[6,]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
[7,]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE
[8,]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE

$lbound: No lower bounds assigned.

$ubound: No upper bounds assigned.</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>SatFit<span class="sc">$</span>MZ.ExpCovMZ</span></code></pre></div>
<pre><code>mxAlgebra &#39;ExpCovMZ&#39; 
$formula:  sdMZ %*% corMZ %*% t(sdMZ) 
$result:
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 1.3364826 0.5997391 0.4797262 0.3825442 0.6430088 0.3962915 0.3655643
[2,] 0.5997391 1.1919879 0.6078295 0.5031812 0.3011712 0.4820850 0.3021533
[3,] 0.4797262 0.6078295 1.6755577 0.9053813 0.2907470 0.4954272 0.6602003
[4,] 0.3825442 0.5031812 0.9053813 1.7591735 0.2541760 0.3606818 0.4944079
[5,] 0.6430088 0.3011712 0.2907470 0.2541760 0.9219520 0.5173482 0.3810986
[6,] 0.3962915 0.4820850 0.4954272 0.3606818 0.5173482 1.0135055 0.4937134
[7,] 0.3655643 0.3021533 0.6602003 0.4944079 0.3810986 0.4937134 1.2621879
[8,] 0.4209707 0.3338308 0.6416395 0.7394846 0.4233755 0.5490217 0.7804457
          [,8]
[1,] 0.4209707
[2,] 0.3338308
[3,] 0.6416395
[4,] 0.7394846
[5,] 0.4233755
[6,] 0.5490217
[7,] 0.7804457
[8,] 1.7016213
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>SatFit<span class="sc">$</span>DZ.corDZ</span></code></pre></div>
<pre><code>StandMatrix &#39;corDZ&#39; 

$labels
     [,1]        [,2]        [,3]        [,4]         [,5]         [,6]        
[1,] NA          &quot;DZrxph1&quot;   &quot;DZrxph2&quot;   &quot;DZrxph3&quot;    &quot;DZrxt1&quot;     &quot;DZrxtxph1&quot; 
[2,] &quot;DZrxph1&quot;   NA          &quot;DZrxph4&quot;   &quot;DZrxph5&quot;    &quot;DZrxtxph4&quot;  &quot;DZrxt2&quot;    
[3,] &quot;DZrxph2&quot;   &quot;DZrxph4&quot;   NA          &quot;DZrxph6&quot;    &quot;DZrxtxph7&quot;  &quot;DZrxtxph8&quot; 
[4,] &quot;DZrxph3&quot;   &quot;DZrxph5&quot;   &quot;DZrxph6&quot;   NA           &quot;DZrxtxph10&quot; &quot;DZrxtxph11&quot;
[5,] &quot;DZrxt1&quot;    &quot;DZrxtxph4&quot; &quot;DZrxtxph7&quot; &quot;DZrxtxph10&quot; NA           &quot;DZrxph7&quot;   
[6,] &quot;DZrxtxph1&quot; &quot;DZrxt2&quot;    &quot;DZrxtxph8&quot; &quot;DZrxtxph11&quot; &quot;DZrxph7&quot;    NA          
[7,] &quot;DZrxtxph2&quot; &quot;DZrxtxph5&quot; &quot;DZrxt3&quot;    &quot;DZrxtxph12&quot; &quot;DZrxph8&quot;    &quot;DZrxph10&quot;  
[8,] &quot;DZrxtxph3&quot; &quot;DZrxtxph6&quot; &quot;DZrxtxph9&quot; &quot;DZrxt4&quot;     &quot;DZrxph9&quot;    &quot;DZrxph11&quot;  
     [,7]         [,8]       
[1,] &quot;DZrxtxph2&quot;  &quot;DZrxtxph3&quot;
[2,] &quot;DZrxtxph5&quot;  &quot;DZrxtxph6&quot;
[3,] &quot;DZrxt3&quot;     &quot;DZrxtxph9&quot;
[4,] &quot;DZrxtxph12&quot; &quot;DZrxt4&quot;   
[5,] &quot;DZrxph8&quot;    &quot;DZrxph9&quot;  
[6,] &quot;DZrxph10&quot;   &quot;DZrxph11&quot; 
[7,] NA           &quot;DZrxph12&quot; 
[8,] &quot;DZrxph12&quot;   NA         

$values
           [,1]       [,2]       [,3]         [,4]         [,5]      [,6]
[1,] 1.00000000 0.53458162 0.40921789  0.372909940  0.056871593 0.1355962
[2,] 0.53458162 1.00000000 0.57906259  0.468407293  0.055624372 0.1988526
[3,] 0.40921789 0.57906259 1.00000000  0.660462621  0.053670638 0.1332703
[4,] 0.37290994 0.46840729 0.66046262  1.000000000 -0.009405021 0.1091486
[5,] 0.05687159 0.05562437 0.05367064 -0.009405021  1.000000000 0.4233537
[6,] 0.13559617 0.19885259 0.13327033  0.109148612  0.423353664 1.0000000
[7,] 0.10801882 0.15546099 0.19020638  0.099239611  0.349709466 0.4829630
[8,] 0.15287635 0.11969977 0.16500579  0.128940673  0.300027273 0.3722624
           [,7]      [,8]
[1,] 0.10801882 0.1528763
[2,] 0.15546099 0.1196998
[3,] 0.19020638 0.1650058
[4,] 0.09923961 0.1289407
[5,] 0.34970947 0.3000273
[6,] 0.48296303 0.3722624
[7,] 1.00000000 0.5692667
[8,] 0.56926666 1.0000000

$free
      [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]
[1,] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[2,]  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
[3,]  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE
[4,]  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
[5,]  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE
[6,]  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
[7,]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE
[8,]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE

$lbound: No lower bounds assigned.

$ubound: No upper bounds assigned.</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>SatFit<span class="sc">$</span>DZ.ExpCovDZ</span></code></pre></div>
<pre><code>mxAlgebra &#39;ExpCovDZ&#39; 
$formula:  sdDZ %*% corDZ %*% t(sdDZ) 
$result:
           [,1]       [,2]       [,3]        [,4]        [,5]      [,6]
[1,] 1.35067219 0.88764495 0.70127028  0.65169335  0.08280247 0.1844191
[2,] 0.88764495 2.04127058 1.21992081  1.00632506  0.09956079 0.3324796
[3,] 0.70127028 1.21992081 2.17426106  1.46442940  0.09914379 0.2299708
[4,] 0.65169335 1.00632506 1.46442940  2.26114651 -0.01771728 0.1920729
[5,] 0.08280247 0.09956079 0.09914379 -0.01771728  1.56944410 0.6206684
[6,] 0.18441906 0.33247957 0.22997082  0.19207285  0.62066845 1.3695151
[7,] 0.16200215 0.28662765 0.36193226  0.19257317  0.56536208 0.7293629
[8,] 0.24116834 0.23213928 0.33026310  0.26318390  0.51019793 0.5913406
          [,7]      [,8]
[1,] 0.1620022 0.2411683
[2,] 0.2866276 0.2321393
[3,] 0.3619323 0.3302631
[4,] 0.1925732 0.2631839
[5,] 0.5653621 0.5101979
[6,] 0.7293629 0.5913406
[7,] 1.6653010 0.9971653
[8,] 0.9971653 1.8425109
dimnames: NULL</code></pre>
</div>
</div>
<div id="saturated-sub-models" class="section level2">
<h2>Saturated sub models</h2>
<p>The saturated model estimates the variances for the variables in MZ and DZ twin pairs, as well as the covariance in each group. The model provides a basis to test assumptions that are implicit in the ACE model:</p>
<ul>
<li>All variances should be non-significantly different</li>
<li>We do not expect birth order nor zygosity effects on the variances</li>
<li>Var1 = Var2 = Var3 = Var4</li>
</ul>
<p>To manipulate the parameters in matrices we wish to change in the full model, we use the ‘omxSetParameters’ function with the original ‘labels’ and ‘newlabels’ to indicate the changes i.e. specifying the same label effectively constraints the parameters to be the same. The correlations estimated by optimizing the saturated Model using OpenMx correct for missingness. The saturated model also gives a baseline fit index (-2 * the likelihood, -2LL) for the observed data, to be used as a reference for comparison with the likelihood (-2LL) of the genetic models.</p>
<div id="saturated-sub-model-1-equal-means-and-variances-across-twin-order-and-zygosity-with-one-set-of-cross-phenotype-correlations-and-symettric-xtwin-xpheno-correlations." class="section level3">
<h3>Saturated <strong>sub-model 1</strong>: Equal means and variances across twin order and zygosity with one set of cross-phenotype correlations and symettric xtwin-xpheno correlations.</h3>
<p>Here we have equated means and variances across twin order and zygosity. Then created one overall set of within-person cross-trait correlations and symmetric xtwin-xtrait correlation matrices in MZ and DZ groups.</p>
<p><em>Labeling</em> 2x2: sisoe5 sisoe7 sisoy5 sisoy7 sisoe5 1.000<br />
sisoe7 xph 1.000<br />
sisoy5 xt1 xtxph 1.000<br />
sisoy7 xtxph xt2 xph 1.000</p>
<p>The full matrix: sisoe5 sisoe7 sisoe10 sisoe12 sisoy5 sisoy7 sisoy10 sisoy12 sisoe5 1.000<br />
sisoe7 xph1 1.000<br />
sisoe10 xph2 xph4 1.000<br />
sisoe12 xph3 xph5 xph6 1.000</p>
<p>sisoy5 xt1 xtxph1 xtxph2 xtxph3 1.000<br />
sisoy7 xtxph1 xt2 xtxph4 xtxph5 xph1 1.000<br />
sisoy10 xtxph2 xtxph4 xt3 xtxph6 xph2 xph4 1.000<br />
sisoy12 xtxph3 xtxph5 xtxph6 xt4 xph3 xph5 xph6 1.000</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># start values</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>sub1svRmz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.3</span>, <span class="dv">16</span>))                    <span class="co"># correlations for MZ - 16 distinct correlations in total</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>sub1svRdz <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.15</span>, <span class="dv">16</span>))                   <span class="co"># correlations for DZ </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># labels</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>sub1labm    <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;m5&quot;</span>, <span class="st">&quot;m7&quot;</span>, <span class="st">&quot;m10&quot;</span>, <span class="st">&quot;m12&quot;</span>, <span class="st">&quot;m5&quot;</span>, <span class="st">&quot;m7&quot;</span>, <span class="st">&quot;m10&quot;</span>, <span class="st">&quot;m12&quot;</span>)             <span class="co"># means       </span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>sub1labsd   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sd5&quot;</span>, <span class="st">&quot;sd7&quot;</span>, <span class="st">&quot;sd10&quot;</span>, <span class="st">&quot;sd12&quot;</span>, <span class="st">&quot;sd5&quot;</span>, <span class="st">&quot;sd7&quot;</span>, <span class="st">&quot;sd10&quot;</span>, <span class="st">&quot;sd12&quot;</span>) <span class="co"># standard deviations</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>sub1labrMZ  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rxph1&quot;</span>, <span class="st">&quot;rxph2&quot;</span>, <span class="st">&quot;rxph3&quot;</span>, <span class="st">&quot;MZrxt1&quot;</span>,   <span class="st">&quot;MZrxtxph1&quot;</span>, <span class="st">&quot;MZrxtxph2&quot;</span>, <span class="st">&quot;MZrxtxph3&quot;</span>,     <span class="co"># MZ correlations</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph4&quot;</span>, <span class="st">&quot;rxph5&quot;</span>, <span class="st">&quot;MZrxtxph1&quot;</span>, <span class="st">&quot;MZrxt2&quot;</span>, <span class="st">&quot;MZrxtxph4&quot;</span>, <span class="st">&quot;MZrxtxph5&quot;</span>, </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph6&quot;</span>, <span class="st">&quot;MZrxtxph2&quot;</span>, <span class="st">&quot;MZrxtxph4&quot;</span>, <span class="st">&quot;MZrxt3&quot;</span>, <span class="st">&quot;MZrxtxph6&quot;</span>,</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;MZrxtxph3&quot;</span>, <span class="st">&quot;MZrxtxph5&quot;</span>, <span class="st">&quot;MZrxtxph6&quot;</span>, <span class="st">&quot;MZrxt4&quot;</span>,</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph1&quot;</span>, <span class="st">&quot;rxph2&quot;</span>, <span class="st">&quot;rxph3&quot;</span>, </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph4&quot;</span>, <span class="st">&quot;rxph5&quot;</span>,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph6&quot;</span>)  </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>sub1labrDZ  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rxph1&quot;</span>, <span class="st">&quot;rxph2&quot;</span>, <span class="st">&quot;rxph3&quot;</span>, <span class="st">&quot;DZrxt1&quot;</span>,   <span class="st">&quot;DZrxtxph1&quot;</span>, <span class="st">&quot;DZrxtxph2&quot;</span>, <span class="st">&quot;DZrxtxph3&quot;</span>,     <span class="co"># DZ correlations</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph4&quot;</span>, <span class="st">&quot;rxph5&quot;</span>, <span class="st">&quot;DZrxtxph1&quot;</span>, <span class="st">&quot;DZrxt2&quot;</span>, <span class="st">&quot;DZrxtxph4&quot;</span>, <span class="st">&quot;DZrxtxph5&quot;</span>, </span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph6&quot;</span>, <span class="st">&quot;DZrxtxph2&quot;</span>, <span class="st">&quot;DZrxtxph4&quot;</span>, <span class="st">&quot;DZrxt3&quot;</span>, <span class="st">&quot;DZrxtxph6&quot;</span>,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;DZrxtxph3&quot;</span>, <span class="st">&quot;DZrxtxph5&quot;</span>, <span class="st">&quot;DZrxtxph6&quot;</span>, <span class="st">&quot;DZrxt4&quot;</span>,</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph1&quot;</span>, <span class="st">&quot;rxph2&quot;</span>, <span class="st">&quot;rxph3&quot;</span>, </span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph4&quot;</span>, <span class="st">&quot;rxph5&quot;</span>,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;rxph6&quot;</span>) </span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create model </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>Sub1Model   <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(SatModel, <span class="at">name =</span> <span class="st">&quot;Sub1&quot;</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># equal means</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>Sub1Model   <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(Sub1Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> labMZm, <span class="at">newlabels =</span> sub1labm)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>Sub1Model   <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(Sub1Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> labDZm, <span class="at">newlabels =</span> sub1labm)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># equal variances</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>Sub1Model   <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(Sub1Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svSD, <span class="at">labels =</span> labMZsd, <span class="at">newlabels =</span> sub1labsd)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>Sub1Model   <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(Sub1Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svSD, <span class="at">labels =</span> labDZsd, <span class="at">newlabels =</span> sub1labsd)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># equal correlations</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>Sub1Model   <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(Sub1Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> sub1svRmz, <span class="at">labels =</span> labMZr, <span class="at">newlabels =</span> sub1labrMZ)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>Sub1Model   <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(Sub1Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> sub1svRdz, <span class="at">labels =</span> labDZr, <span class="at">newlabels =</span> sub1labrDZ)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co"># for some reason it&#39;s the wrong number of starting values so to choose randomly I&#39;ve set the below</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>Sub1Model <span class="ot">&lt;-</span> <span class="fu">omxAssignFirstParameters</span>(Sub1Model)</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Sub1Fit <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(Sub1Model, <span class="at">intervals =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>(Sub1Summ   <span class="ot">&lt;-</span> <span class="fu">summary</span>(Sub1Fit))</span></code></pre></div>
<pre><code>Summary of Sub1 
 
free parameters:
        name       matrix row     col   Estimate  Std.Error A
1         m5 MZ.ExpMeanMZ   1  sisoe5 0.83192099 0.02777049  
2         m7 MZ.ExpMeanMZ   1  sisoe7 0.84709597 0.02943890  
3        m10 MZ.ExpMeanMZ   1 sisoe10 0.95577705 0.03242446  
4        m12 MZ.ExpMeanMZ   1 sisoe12 0.95821486 0.03373931  
5        sd5      MZ.sdMZ   1       1 1.14535328 0.01877452  
6        sd7      MZ.sdMZ   2       2 1.19010919 0.01955806  
7       sd10      MZ.sdMZ   3       3 1.30890870 0.02146838  
8       sd12      MZ.sdMZ   4       4 1.38276806 0.02245679  
9      rxph1     MZ.corMZ   1       2 0.49430163 0.01747086  
10     rxph2     MZ.corMZ   1       3 0.36512632 0.02007466  
11     rxph4     MZ.corMZ   2       3 0.50166737 0.01722414  
12     rxph3     MZ.corMZ   1       4 0.32246616 0.02062373  
13     rxph5     MZ.corMZ   2       4 0.41559538 0.01917806  
14     rxph6     MZ.corMZ   3       4 0.58351499 0.01503894  
15    MZrxt1     MZ.corMZ   1       5 0.61362644 0.02432056  
16 MZrxtxph1     MZ.corMZ   2       5 0.33431833 0.02591213  
17 MZrxtxph2     MZ.corMZ   3       5 0.29295734 0.02552871  
18 MZrxtxph3     MZ.corMZ   4       5 0.27949244 0.02537456  
19    MZrxt2     MZ.corMZ   2       6 0.51726912 0.03175022  
20 MZrxtxph4     MZ.corMZ   3       6 0.38499758 0.02602662  
21 MZrxtxph5     MZ.corMZ   4       6 0.30329708 0.02700132  
22    MZrxt3     MZ.corMZ   3       7 0.50703825 0.03021923  
23 MZrxtxph6     MZ.corMZ   4       7 0.41313438 0.02550948  
24    MZrxt4     MZ.corMZ   4       8 0.47158545 0.03090698  
25    DZrxt1     DZ.corDZ   1       5 0.05385703 0.04033642  
26 DZrxtxph1     DZ.corDZ   2       5 0.08246045 0.03082892  
27 DZrxtxph2     DZ.corDZ   3       5 0.06927512 0.03039158  
28 DZrxtxph3     DZ.corDZ   4       5 0.06070762 0.03067409  
29    DZrxt2     DZ.corDZ   2       6 0.16934065 0.03717709  
30 DZrxtxph4     DZ.corDZ   3       6 0.11742856 0.03032439  
31 DZrxtxph5     DZ.corDZ   4       6 0.09952729 0.03060210  
32    DZrxt3     DZ.corDZ   3       7 0.16339936 0.03984079  
33 DZrxtxph6     DZ.corDZ   4       7 0.11110835 0.03307787  
34    DZrxt4     DZ.corDZ   4       8 0.11576113 0.04210533  

Model Statistics: 
               |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
       Model:             34                   8659              25701.12
   Saturated:             NA                     NA                    NA
Independence:             NA                     NA                    NA
Number of observations/statistics: 1116/8693

Information Criteria: 
      |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
AIC:       8383.125               25769.12                 25771.33
BIC:     -35063.461               25939.72                 25831.73
CFI: NA 
TLI: 1   (also known as NNFI) 
RMSEA:  0  [95% CI (NA, NA)]
Prob(RMSEA &lt;= 0.05): NA
To get additional fit indices, see help(mxRefModels)
timestamp: 2022-10-03 14:19:56 
Wall clock time: 0.418009 secs 
optimizer:  SLSQP 
OpenMx version number: 2.20.3 
Need help?  See help(mxSummary) </code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>Sub1Fit<span class="sc">$</span>MZ.ExpCovMZ</span></code></pre></div>
<pre><code>mxAlgebra &#39;ExpCovMZ&#39; 
$formula:  sdMZ %*% corMZ %*% t(sdMZ) 
$result:
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 1.3118341 0.6737803 0.5473838 0.5107083 0.8049761 0.4557078 0.4391908
[2,] 0.6737803 1.4163599 0.7814695 0.6839224 0.4557078 0.7326392 0.5997278
[3,] 0.5473838 0.7814695 1.7132420 1.0561138 0.4391908 0.5997278 0.8686792
[4,] 0.5107083 0.6839224 1.0561138 1.9120475 0.4426484 0.4991193 0.7477390
[5,] 0.8049761 0.4557078 0.4391908 0.4426484 1.3118341 0.6737803 0.5473838
[6,] 0.4557078 0.7326392 0.5997278 0.4991193 0.6737803 1.4163599 0.7814695
[7,] 0.4391908 0.5997278 0.8686792 0.7477390 0.5473838 0.7814695 1.7132420
[8,] 0.4426484 0.4991193 0.7477390 0.9016938 0.5107083 0.6839224 1.0561138
          [,8]
[1,] 0.4426484
[2,] 0.4991193
[3,] 0.7477390
[4,] 0.9016938
[5,] 0.5107083
[6,] 0.6839224
[7,] 1.0561138
[8,] 1.9120475
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>Sub1Fit<span class="sc">$</span>MZ.MZCor</span></code></pre></div>
<pre><code>NULL</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>Sub1Fit<span class="sc">$</span>DZ.ExpCovDZ</span></code></pre></div>
<pre><code>mxAlgebra &#39;ExpCovDZ&#39; 
$formula:  sdDZ %*% corDZ %*% t(sdDZ) 
$result:
           [,1]      [,2]      [,3]       [,4]       [,5]      [,6]      [,7]
[1,] 1.31183413 0.6737803 0.5473838 0.51070833 0.07065149 0.1124015 0.1038547
[2,] 0.67378031 1.4163599 0.7814695 0.68392245 0.11240147 0.2398473 0.1829237
[3,] 0.54738382 0.7814695 1.7132420 1.05611379 0.10385469 0.1829237 0.2799426
[4,] 0.51070833 0.6839224 1.0561138 1.91204752 0.09614617 0.1637866 0.2010969
[5,] 0.07065149 0.1124015 0.1038547 0.09614617 1.31183413 0.6737803 0.5473838
[6,] 0.11240147 0.2398473 0.1829237 0.16378659 0.67378031 1.4163599 0.7814695
[7,] 0.10385469 0.1829237 0.2799426 0.20109690 0.54738382 0.7814695 1.7132420
[8,] 0.09614617 0.1637866 0.2010969 0.22134077 0.51070833 0.6839224 1.0561138
           [,8]
[1,] 0.09614617
[2,] 0.16378659
[3,] 0.20109690
[4,] 0.22134077
[5,] 0.51070833
[6,] 0.68392245
[7,] 1.05611379
[8,] 1.91204752
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>Sub1Fit<span class="sc">$</span>DZ.DZCor</span></code></pre></div>
<pre><code>NULL</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the fit to the saturated model</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mxCompare</span>(SatFit, Sub1Fit)</span></code></pre></div>
<pre><code>  base comparison ep minus2LL   df      AIC   diffLL diffdf            p
1  Sat       &lt;NA&gt; 88 25456.57 8605 25632.57       NA     NA           NA
2  Sat       Sub1 34 25701.12 8659 25769.12 244.5563     54 4.606409e-26</code></pre>
<p>As the p-value is significant, the sub-model is significantly worse fit compared to the saturated model. Now we will constrain different aspects here to see where the inequality in variance is coming up.</p>
</div>
<div id="saturated-sub-model-2-equal-variancessd-across-twin-order" class="section level3">
<h3>Saturated <strong>sub-model 2</strong>: equal variances/sd across twin order</h3>
<p>We will run equal variances across twin order only.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>sub2labMZsd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MZsd5&quot;</span>, <span class="st">&quot;MZsd7&quot;</span>, <span class="st">&quot;MZsd10&quot;</span>, <span class="st">&quot;MZsd12&quot;</span>, <span class="st">&quot;MZsd5&quot;</span>, <span class="st">&quot;MZsd7&quot;</span>, <span class="st">&quot;MZsd10&quot;</span>, <span class="st">&quot;MZsd12&quot;</span>)   <span class="co"># MZ standard deviations</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>sub2labDZsd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DZsd5&quot;</span>, <span class="st">&quot;DZsd7&quot;</span>, <span class="st">&quot;DZsd10&quot;</span>, <span class="st">&quot;DZsd12&quot;</span>, <span class="st">&quot;DZsd5&quot;</span>, <span class="st">&quot;DZsd7&quot;</span>, <span class="st">&quot;DZsd10&quot;</span>, <span class="st">&quot;DZsd12&quot;</span>)   <span class="co"># DZ standard deviations</span></span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>Sub2Model <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(SatModel, <span class="at">name =</span> <span class="st">&quot;Sub2&quot;</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>Sub2Model <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(Sub2Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svSD, <span class="at">labels =</span> labMZsd, <span class="at">newlabels =</span> sub2labMZsd)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>Sub2Model <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(Sub2Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svSD, <span class="at">labels =</span> labDZsd, <span class="at">newlabels =</span> sub2labDZsd)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>Sub2Fit <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(Sub2Model, <span class="at">intervals =</span> <span class="cn">TRUE</span>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>(Sub2Summ   <span class="ot">&lt;-</span> <span class="fu">summary</span>(Sub2Fit))</span></code></pre></div>
<pre><code>Summary of Sub2 
 
free parameters:
         name       matrix row     col     Estimate  Std.Error A
1       MZme5 MZ.ExpMeanMZ   1  sisoe5  0.766265922 0.04284455  
2       MZme7 MZ.ExpMeanMZ   1  sisoe7  0.788664935 0.04273615  
3      MZme10 MZ.ExpMeanMZ   1 sisoe10  0.923793249 0.04970240  
4      MZme12 MZ.ExpMeanMZ   1 sisoe12  0.878200131 0.05393420  
5       MZmy5 MZ.ExpMeanMZ   1  sisoy5  0.695894824 0.04284459  
6       MZmy7 MZ.ExpMeanMZ   1  sisoy7  0.687165209 0.04265992  
7      MZmy10 MZ.ExpMeanMZ   1 sisoy10  0.811806166 0.04965268  
8      MZmy12 MZ.ExpMeanMZ   1 sisoy12  0.825199214 0.05386753  
9       MZsd5      MZ.sdMZ   1       1  1.067540065 0.02479332  
10      MZsd7      MZ.sdMZ   2       2  1.054837075 0.02351395  
11     MZsd10      MZ.sdMZ   3       3  1.216366774 0.02751850  
12     MZsd12      MZ.sdMZ   4       4  1.321201352 0.02971274  
13    MZrxph1     MZ.corMZ   1       2  0.443266356 0.03004388  
14    MZrxph2     MZ.corMZ   1       3  0.299707602 0.03320992  
15    MZrxph4     MZ.corMZ   2       3  0.404431729 0.03162721  
16    MZrxph3     MZ.corMZ   1       4  0.233832223 0.03622933  
17    MZrxph5     MZ.corMZ   2       4  0.328123203 0.03537080  
18    MZrxph6     MZ.corMZ   3       4  0.508770021 0.02866398  
19     MZrxt1     MZ.corMZ   1       5  0.572486383 0.02714364  
20  MZrxtxph4     MZ.corMZ   2       5  0.270791885 0.04072489  
21  MZrxtxph7     MZ.corMZ   3       5  0.233956774 0.03993444  
22 MZrxtxph10     MZ.corMZ   4       5  0.202611358 0.04336207  
23  MZrxtxph1     MZ.corMZ   1       6  0.354006727 0.03380281  
24     MZrxt2     MZ.corMZ   2       6  0.427189269 0.03419787  
25  MZrxtxph8     MZ.corMZ   3       6  0.373688563 0.03505328  
26 MZrxtxph11     MZ.corMZ   4       6  0.267951441 0.04022766  
27    MZrxph7     MZ.corMZ   5       6  0.582493754 0.02728483  
28  MZrxtxph2     MZ.corMZ   1       7  0.290400300 0.03690293  
29  MZrxtxph5     MZ.corMZ   2       7  0.237404506 0.04036561  
30     MZrxt3     MZ.corMZ   3       7  0.449446796 0.03305119  
31 MZrxtxph12     MZ.corMZ   4       7  0.330082447 0.03965149  
32    MZrxph8     MZ.corMZ   5       7  0.402619251 0.03871914  
33   MZrxph10     MZ.corMZ   6       7  0.474622142 0.03351531  
34  MZrxtxph3     MZ.corMZ   1       8  0.285137298 0.03509832  
35  MZrxtxph6     MZ.corMZ   2       8  0.226871196 0.03855757  
36  MZrxtxph9     MZ.corMZ   3       8  0.378202024 0.03388934  
37     MZrxt4     MZ.corMZ   4       8  0.425949790 0.03406066  
38    MZrxph9     MZ.corMZ   5       8  0.372832949 0.03718046  
39   MZrxph11     MZ.corMZ   6       8  0.445083458 0.03322690  
40   MZrxph12     MZ.corMZ   7       8  0.559508148 0.02877579  
41      DZme5 DZ.ExpMeanDZ   1  sisoe5  0.896162012 0.05419171  
42      DZme7 DZ.ExpMeanDZ   1  sisoe7  0.991864339 0.05934369  
43     DZme10 DZ.ExpMeanDZ   1 sisoe10  1.118088088 0.06301391  
44     DZme12 DZ.ExpMeanDZ   1 sisoe12  1.110549751 0.06525185  
45      DZmy5 DZ.ExpMeanDZ   1  sisoy5  0.935555566 0.05419163  
46      DZmy7 DZ.ExpMeanDZ   1  sisoy7  0.903439563 0.05937612  
47     DZmy10 DZ.ExpMeanDZ   1 sisoy10  0.944721916 0.06302496  
48     DZmy12 DZ.ExpMeanDZ   1 sisoy12  0.996094471 0.06526453  
49      DZsd5      DZ.sdDZ   1       1  1.205648549 0.02729990  
50      DZsd7      DZ.sdDZ   2       2  1.309924728 0.03055005  
51     DZsd10      DZ.sdDZ   3       3  1.385490171 0.03230149  
52     DZsd12      DZ.sdDZ   4       4  1.432831371 0.03335079  
53    DZrxph1     DZ.corDZ   1       2  0.512534524 0.03110813  
54    DZrxph2     DZ.corDZ   1       3  0.380747216 0.03763294  
55    DZrxph4     DZ.corDZ   2       3  0.539983264 0.02878286  
56    DZrxph3     DZ.corDZ   1       4  0.348048720 0.03916738  
57    DZrxph5     DZ.corDZ   2       4  0.429298838 0.03386373  
58    DZrxph6     DZ.corDZ   3       4  0.630872061 0.02477433  
59     DZrxt1     DZ.corDZ   1       5  0.067128269 0.04491840  
60  DZrxtxph4     DZ.corDZ   2       5  0.066554592 0.04024467  
61  DZrxtxph7     DZ.corDZ   3       5  0.062537628 0.04154309  
62 DZrxtxph10     DZ.corDZ   4       5 -0.001080649 0.04236444  
63  DZrxtxph1     DZ.corDZ   1       6  0.143029474 0.05205107  
64     DZrxt2     DZ.corDZ   2       6  0.201251765 0.04386604  
65  DZrxtxph8     DZ.corDZ   3       6  0.133341063 0.04699963  
66 DZrxtxph11     DZ.corDZ   4       6  0.108842244 0.04883930  
67    DZrxph7     DZ.corDZ   5       6  0.444328201 0.03629381  
68  DZrxtxph2     DZ.corDZ   1       7  0.115368055 0.05043119  
69  DZrxtxph5     DZ.corDZ   2       7  0.158684002 0.04339147  
70     DZrxt3     DZ.corDZ   3       7  0.190760398 0.04411974  
71 DZrxtxph12     DZ.corDZ   4       7  0.097448741 0.04661131  
72    DZrxph8     DZ.corDZ   5       7  0.374259321 0.03814329  
73   DZrxph10     DZ.corDZ   6       7  0.537897830 0.03383152  
74  DZrxtxph3     DZ.corDZ   1       8  0.165155960 0.04855950  
75  DZrxtxph6     DZ.corDZ   2       8  0.128412496 0.04348795  
76  DZrxtxph9     DZ.corDZ   3       8  0.170467699 0.04379090  
77     DZrxt4     DZ.corDZ   4       8  0.130559552 0.04527999  
78    DZrxph9     DZ.corDZ   5       8  0.323776612 0.03947029  
79   DZrxph11     DZ.corDZ   6       8  0.425817362 0.03988567  
80   DZrxph12     DZ.corDZ   7       8  0.608410266 0.02844183  

Model Statistics: 
               |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
       Model:             80                   8613              25533.87
   Saturated:             NA                     NA                    NA
Independence:             NA                     NA                    NA
Number of observations/statistics: 1116/8693

Information Criteria: 
      |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
AIC:       8307.869               25693.87                 25706.39
BIC:     -34907.912               26095.27                 25841.17
CFI: NA 
TLI: 1   (also known as NNFI) 
RMSEA:  0  [95% CI (NA, NA)]
Prob(RMSEA &lt;= 0.05): NA
To get additional fit indices, see help(mxRefModels)
timestamp: 2022-10-03 14:19:58 
Wall clock time: 1.767729 secs 
optimizer:  SLSQP 
OpenMx version number: 2.20.3 
Need help?  See help(mxSummary) </code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to saturated</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mxCompare</span>(SatFit, Sub2Fit)</span></code></pre></div>
<pre><code>  base comparison ep minus2LL   df      AIC   diffLL diffdf            p
1  Sat       &lt;NA&gt; 88 25456.57 8605 25632.57       NA     NA           NA
2  Sat       Sub2 80 25533.87 8613 25693.87 77.30028      8 1.705622e-13</code></pre>
<p>This is significant, suggesting that the variance is not equal across elder and younger twins within MZ and DZ groups separately.</p>
</div>
<div id="saturated-sub-model-3-equal-variancessd-across-zygosity" class="section level3">
<h3>Saturated <em>sub-model 3</em>: equal variances/sd across zygosity</h3>
<p>We will run equal variances across zygosity only (as the twin order test was significant).</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>sub3labMZsd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sde5&quot;</span>, <span class="st">&quot;sde7&quot;</span>, <span class="st">&quot;sde10&quot;</span>, <span class="st">&quot;sde12&quot;</span>, <span class="st">&quot;sdy5&quot;</span>, <span class="st">&quot;sdy7&quot;</span>, <span class="st">&quot;sdy10&quot;</span>, <span class="st">&quot;sdy12&quot;</span>)   <span class="co"># MZ standard deviations</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>sub3labDZsd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sde5&quot;</span>, <span class="st">&quot;sde7&quot;</span>, <span class="st">&quot;sde10&quot;</span>, <span class="st">&quot;sde12&quot;</span>, <span class="st">&quot;sdy5&quot;</span>, <span class="st">&quot;sdy7&quot;</span>, <span class="st">&quot;sdy10&quot;</span>, <span class="st">&quot;sdy12&quot;</span>)   <span class="co"># DZ standard deviations</span></span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>sub3Model <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(SatModel, <span class="at">name =</span> <span class="st">&quot;sub3&quot;</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>sub3Model <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(sub3Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svSD, <span class="at">labels =</span> labMZsd, <span class="at">newlabels =</span> sub3labMZsd)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>sub3Model <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(sub3Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svSD, <span class="at">labels =</span> labDZsd, <span class="at">newlabels =</span> sub3labDZsd)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>sub3Fit <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(sub3Model, <span class="at">intervals =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>(sub3Summ   <span class="ot">&lt;-</span> <span class="fu">summary</span>(sub3Fit))</span></code></pre></div>
<pre><code>Summary of sub3 
 
free parameters:
         name       matrix row     col    Estimate  Std.Error A
1       MZme5 MZ.ExpMeanMZ   1  sisoe5  0.76626380 0.04796311  
2       MZme7 MZ.ExpMeanMZ   1  sisoe7  0.78874968 0.05124173  
3      MZme10 MZ.ExpMeanMZ   1 sisoe10  0.92373175 0.05665819  
4      MZme12 MZ.ExpMeanMZ   1 sisoe12  0.87837563 0.05779840  
5       MZmy5 MZ.ExpMeanMZ   1  sisoy5  0.69589355 0.04419751  
6       MZmy7 MZ.ExpMeanMZ   1  sisoy7  0.68721601 0.04503230  
7      MZmy10 MZ.ExpMeanMZ   1 sisoy10  0.81157777 0.04959498  
8      MZmy12 MZ.ExpMeanMZ   1 sisoy12  0.82535813 0.05494024  
9        sde5      MZ.sdMZ   1       1  1.19536067 0.02620773  
10       sde7      MZ.sdMZ   2       2  1.26662919 0.02746772  
11      sde10      MZ.sdMZ   3       3  1.38973125 0.03027499  
12      sde12      MZ.sdMZ   4       4  1.41810257 0.03095972  
13       sdy5      MZ.sdMZ   5       5  1.10151390 0.02286910  
14       sdy7      MZ.sdMZ   6       6  1.11437972 0.02458957  
15      sdy10      MZ.sdMZ   7       7  1.21611281 0.02670259  
16      sdy12      MZ.sdMZ   8       8  1.34868842 0.02979076  
17    MZrxph1     MZ.corMZ   1       2  0.53725158 0.02962487  
18    MZrxph2     MZ.corMZ   1       3  0.38904563 0.03452672  
19    MZrxph4     MZ.corMZ   2       3  0.50812074 0.03196336  
20    MZrxph3     MZ.corMZ   1       4  0.31612337 0.03745382  
21    MZrxph5     MZ.corMZ   2       4  0.42408078 0.03652075  
22    MZrxph6     MZ.corMZ   3       4  0.57850343 0.02697284  
23     MZrxt1     MZ.corMZ   1       5  0.62917923 0.02375504  
24  MZrxtxph4     MZ.corMZ   2       5  0.37564807 0.04076648  
25  MZrxtxph7     MZ.corMZ   3       5  0.31464405 0.04062691  
26 MZrxtxph10     MZ.corMZ   4       5  0.27230146 0.04240594  
27  MZrxtxph1     MZ.corMZ   1       6  0.43374645 0.03151851  
28     MZrxt2     MZ.corMZ   2       6  0.52604798 0.03137628  
29  MZrxtxph8     MZ.corMZ   3       6  0.45780464 0.03332502  
30 MZrxtxph11     MZ.corMZ   4       6  0.34799851 0.03821948  
31    MZrxph7     MZ.corMZ   5       6  0.61334365 0.02567715  
32  MZrxtxph2     MZ.corMZ   1       7  0.35458166 0.03587892  
33  MZrxtxph5     MZ.corMZ   2       7  0.33131314 0.04059328  
34     MZrxt3     MZ.corMZ   3       7  0.51123949 0.03064200  
35 MZrxtxph12     MZ.corMZ   4       7  0.39154101 0.03613481  
36    MZrxph8     MZ.corMZ   5       7  0.43164417 0.03608162  
37   MZrxph10     MZ.corMZ   6       7  0.50845830 0.03115329  
38  MZrxtxph3     MZ.corMZ   1       8  0.34270601 0.03513493  
39  MZrxtxph6     MZ.corMZ   2       8  0.30883457 0.04010717  
40  MZrxtxph9     MZ.corMZ   3       8  0.43606225 0.03302952  
41     MZrxt4     MZ.corMZ   4       8  0.47212914 0.03152161  
42    MZrxph9     MZ.corMZ   5       8  0.40485454 0.03558256  
43   MZrxph11     MZ.corMZ   6       8  0.47895531 0.03190180  
44   MZrxph12     MZ.corMZ   7       8  0.57698557 0.02685477  
45      DZme5 DZ.ExpMeanDZ   1  sisoe5  0.89616276 0.05372663  
46      DZme7 DZ.ExpMeanDZ   1  sisoe7  0.99190893 0.05739174  
47     DZme10 DZ.ExpMeanDZ   1 sisoe10  1.11832396 0.06321666  
48     DZme12 DZ.ExpMeanDZ   1 sisoe12  1.11066526 0.06458781  
49      DZmy5 DZ.ExpMeanDZ   1  sisoy5  0.93555571 0.04950763  
50      DZmy7 DZ.ExpMeanDZ   1  sisoy7  0.90327013 0.05056511  
51     DZmy10 DZ.ExpMeanDZ   1 sisoy10  0.94547469 0.05540358  
52     DZmy12 DZ.ExpMeanDZ   1 sisoy12  0.99627182 0.06150636  
53    DZrxph1     DZ.corDZ   1       2  0.49787267 0.03080922  
54    DZrxph2     DZ.corDZ   1       3  0.36996713 0.03811582  
55    DZrxph4     DZ.corDZ   2       3  0.52888280 0.02859019  
56    DZrxph3     DZ.corDZ   1       4  0.33917845 0.03889354  
57    DZrxph5     DZ.corDZ   2       4  0.41995181 0.03287508  
58    DZrxph6     DZ.corDZ   3       4  0.62820106 0.02463122  
59     DZrxt1     DZ.corDZ   1       5  0.04713905 0.04049732  
60  DZrxtxph4     DZ.corDZ   2       5  0.04317766 0.03624623  
61  DZrxtxph7     DZ.corDZ   3       5  0.04279713 0.03848678  
62 DZrxtxph10     DZ.corDZ   4       5 -0.01303534 0.03851149  
63  DZrxtxph1     DZ.corDZ   1       6  0.11520589 0.04409560  
64     DZrxt2     DZ.corDZ   2       6  0.17353308 0.03778374  
65  DZrxtxph8     DZ.corDZ   3       6  0.10623108 0.04142198  
66 DZrxtxph11     DZ.corDZ   4       6  0.09178250 0.04206293  
67    DZrxph7     DZ.corDZ   5       6  0.37387459 0.03363328  
68  DZrxtxph2     DZ.corDZ   1       7  0.08969257 0.04387023  
69  DZrxtxph5     DZ.corDZ   2       7  0.13186725 0.03808329  
70     DZrxt3     DZ.corDZ   3       7  0.17043562 0.03980816  
71 DZrxtxph12     DZ.corDZ   4       7  0.08361571 0.04100832  
72    DZrxph8     DZ.corDZ   5       7  0.30421915 0.03525613  
73   DZrxph10     DZ.corDZ   6       7  0.44561989 0.03315939  
74  DZrxtxph3     DZ.corDZ   1       8  0.14713199 0.04568413  
75  DZrxtxph6     DZ.corDZ   2       8  0.10254672 0.04039800  
76  DZrxtxph9     DZ.corDZ   3       8  0.15059396 0.04206943  
77     DZrxt4     DZ.corDZ   4       8  0.12013431 0.04247431  
78    DZrxph9     DZ.corDZ   5       8  0.25940684 0.03765584  
79   DZrxph11     DZ.corDZ   6       8  0.33888640 0.03853173  
80   DZrxph12     DZ.corDZ   7       8  0.54527498 0.02972498  

Model Statistics: 
               |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
       Model:             80                   8613              25547.36
   Saturated:             NA                     NA                    NA
Independence:             NA                     NA                    NA
Number of observations/statistics: 1116/8693

Information Criteria: 
      |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
AIC:       8321.359               25707.36                 25719.88
BIC:     -34894.421               26108.76                 25854.66
CFI: NA 
TLI: 1   (also known as NNFI) 
RMSEA:  0  [95% CI (NA, NA)]
Prob(RMSEA &lt;= 0.05): NA
To get additional fit indices, see help(mxRefModels)
timestamp: 2022-10-03 14:20:00 
Wall clock time: 1.805141 secs 
optimizer:  SLSQP 
OpenMx version number: 2.20.3 
Need help?  See help(mxSummary) </code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to saturated</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mxCompare</span>(SatFit, sub3Fit)</span></code></pre></div>
<pre><code>  base comparison ep minus2LL   df      AIC   diffLL diffdf            p
1  Sat       &lt;NA&gt; 88 25456.57 8605 25632.57       NA     NA           NA
2  Sat       sub3 80 25547.36 8613 25707.36 90.79034      8 3.213728e-16</code></pre>
<p>This is also significant, suggesting that the variance is not equal across MZ and DZ groups, even when not restricting to twin-order.</p>
</div>
<div id="saturated-sub-model-4-equal-means-across-twin-order" class="section level3">
<h3>Saturated <em>sub-model 4</em>: equal means across twin order</h3>
<p>We will run equal means across twin order only.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>sub4labMZm  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MZm5&quot;</span>, <span class="st">&quot;MZm7&quot;</span>, <span class="st">&quot;MZm10&quot;</span>, <span class="st">&quot;MZm12&quot;</span>, <span class="st">&quot;MZm5&quot;</span>, <span class="st">&quot;MZm7&quot;</span>, <span class="st">&quot;MZm10&quot;</span>, <span class="st">&quot;MZm12&quot;</span>)             <span class="co"># MZ means       </span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>sub4labDZm  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;DZm5&quot;</span>, <span class="st">&quot;DZm7&quot;</span>, <span class="st">&quot;DZm10&quot;</span>, <span class="st">&quot;DZm12&quot;</span>, <span class="st">&quot;DZm5&quot;</span>, <span class="st">&quot;DZm7&quot;</span>, <span class="st">&quot;DZm10&quot;</span>, <span class="st">&quot;DZm12&quot;</span>)           <span class="co"># DZ means</span></span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>sub4Model <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(SatModel, <span class="at">name =</span> <span class="st">&quot;sub4&quot;</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>sub4Model <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(sub4Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> labMZm, <span class="at">newlabels =</span> sub4labMZm)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>sub4Model <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(sub4Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> labDZm, <span class="at">newlabels =</span> sub4labDZm)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>sub4Fit <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(sub4Model, <span class="at">intervals =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>(sub4Summ   <span class="ot">&lt;-</span> <span class="fu">summary</span>(sub4Fit))</span></code></pre></div>
<pre><code>Summary of sub4 
 
free parameters:
         name       matrix row     col     Estimate  Std.Error A
1        MZm5 MZ.ExpMeanMZ   1  sisoe5  0.722953006 0.03676563  
2        MZm7 MZ.ExpMeanMZ   1  sisoe7  0.721379294 0.03573421  
3       MZm10 MZ.ExpMeanMZ   1 sisoe10  0.855368572 0.04153832  
4       MZm12 MZ.ExpMeanMZ   1 sisoe12  0.844359714 0.04522398  
5      MZsde5      MZ.sdMZ   1       1  1.156874471 0.03286239  
6      MZsde7      MZ.sdMZ   2       2  1.093854541 0.03149831  
7     MZsde10      MZ.sdMZ   3       3  1.296249019 0.03758733  
8     MZsde12      MZ.sdMZ   4       4  1.326751962 0.03831985  
9      MZsdy5      MZ.sdMZ   5       5  0.960564288 0.02728063  
10     MZsdy7      MZ.sdMZ   6       6  1.007378815 0.02897181  
11    MZsdy10      MZ.sdMZ   7       7  1.124508077 0.03276791  
12    MZsdy12      MZ.sdMZ   8       8  1.304598247 0.03770228  
13    MZrxph1     MZ.corMZ   1       2  0.476223411 0.03150768  
14    MZrxph2     MZ.corMZ   1       3  0.321604996 0.03685172  
15    MZrxph4     MZ.corMZ   2       3  0.431996960 0.03327486  
16    MZrxph3     MZ.corMZ   1       4  0.250092397 0.03849422  
17    MZrxph5     MZ.corMZ   2       4  0.348428737 0.03588054  
18    MZrxph6     MZ.corMZ   3       4  0.528002067 0.02960741  
19     MZrxt1     MZ.corMZ   1       5  0.577580934 0.02675264  
20  MZrxtxph4     MZ.corMZ   2       5  0.284852087 0.03747883  
21  MZrxtxph7     MZ.corMZ   3       5  0.232012058 0.03883701  
22 MZrxtxph10     MZ.corMZ   4       5  0.198827853 0.03900246  
23  MZrxtxph1     MZ.corMZ   1       6  0.338749275 0.03604091  
24     MZrxt2     MZ.corMZ   2       6  0.435274155 0.03299401  
25  MZrxtxph8     MZ.corMZ   3       6  0.377466851 0.03550303  
26 MZrxtxph11     MZ.corMZ   4       6  0.268889319 0.03815417  
27    MZrxph7     MZ.corMZ   5       6  0.535607079 0.02904236  
28  MZrxtxph2     MZ.corMZ   1       7  0.279757310 0.03791426  
29  MZrxtxph5     MZ.corMZ   2       7  0.242876509 0.03847661  
30     MZrxt3     MZ.corMZ   3       7  0.450676369 0.03276172  
31 MZrxtxph12     MZ.corMZ   4       7  0.330185357 0.03663040  
32    MZrxph8     MZ.corMZ   5       7  0.353946519 0.03592319  
33   MZrxph10     MZ.corMZ   6       7  0.437489071 0.03336702  
34  MZrxtxph3     MZ.corMZ   1       8  0.278432317 0.03785521  
35  MZrxtxph6     MZ.corMZ   2       8  0.232734472 0.03897661  
36  MZrxtxph9     MZ.corMZ   3       8  0.378286518 0.03557217  
37     MZrxt4     MZ.corMZ   4       8  0.426872935 0.03342015  
38    MZrxph9     MZ.corMZ   5       8  0.338198315 0.03598114  
39   MZrxph11     MZ.corMZ   6       8  0.418449994 0.03422290  
40   MZrxph12     MZ.corMZ   7       8  0.532899956 0.02979963  
41       DZm5 DZ.ExpMeanDZ   1  sisoe5  0.907295597 0.03934768  
42       DZm7 DZ.ExpMeanDZ   1  sisoe7  0.935403048 0.04505607  
43      DZm10 DZ.ExpMeanDZ   1 sisoe10  1.015351778 0.04816598  
44      DZm12 DZ.ExpMeanDZ   1 sisoe12  1.039602158 0.04854252  
45     DZsde5      DZ.sdDZ   1       1  1.162237577 0.03694447  
46     DZsde7      DZ.sdDZ   2       2  1.429884489 0.04591852  
47    DZsde10      DZ.sdDZ   3       3  1.477803335 0.04765912  
48    DZsde12      DZ.sdDZ   4       4  1.505305985 0.04870531  
49     DZsdy5      DZ.sdDZ   5       5  1.253092824 0.03983762  
50     DZsdy7      DZ.sdDZ   6       6  1.170697478 0.03767248  
51    DZsdy10      DZ.sdDZ   7       7  1.292141404 0.04173154  
52    DZsdy12      DZ.sdDZ   8       8  1.358027848 0.04417835  
53    DZrxph1     DZ.corDZ   1       2  0.533893822 0.03241470  
54    DZrxph2     DZ.corDZ   1       3  0.407716186 0.03790919  
55    DZrxph4     DZ.corDZ   2       3  0.579579695 0.03074697  
56    DZrxph3     DZ.corDZ   1       4  0.372148750 0.03911986  
57    DZrxph5     DZ.corDZ   2       4  0.469030135 0.03671812  
58    DZrxph6     DZ.corDZ   3       4  0.661310058 0.02583893  
59     DZrxt1     DZ.corDZ   1       5  0.056639001 0.04482247  
60  DZrxtxph4     DZ.corDZ   2       5  0.056385107 0.04529689  
61  DZrxtxph7     DZ.corDZ   3       5  0.055451535 0.04563588  
62 DZrxtxph10     DZ.corDZ   4       5 -0.008205144 0.04578391  
63  DZrxtxph1     DZ.corDZ   1       6  0.135676784 0.04431860  
64     DZrxt2     DZ.corDZ   2       6  0.197514342 0.04366354  
65  DZrxtxph8     DZ.corDZ   3       6  0.131098646 0.04521390  
66 DZrxtxph11     DZ.corDZ   4       6  0.107899685 0.04606889  
67    DZrxph7     DZ.corDZ   5       6  0.422541027 0.03744149  
68  DZrxtxph2     DZ.corDZ   1       7  0.108328403 0.04484371  
69  DZrxtxph5     DZ.corDZ   2       7  0.153540545 0.04456972  
70     DZrxt3     DZ.corDZ   3       7  0.186169646 0.04399249  
71 DZrxtxph12     DZ.corDZ   4       7  0.096697423 0.04558755  
72    DZrxph8     DZ.corDZ   5       7  0.347607827 0.04039821  
73   DZrxph10     DZ.corDZ   6       7  0.483525123 0.03502082  
74  DZrxtxph3     DZ.corDZ   1       8  0.153014792 0.04433806  
75  DZrxtxph6     DZ.corDZ   2       8  0.118562892 0.04548628  
76  DZrxtxph9     DZ.corDZ   3       8  0.162745546 0.04449298  
77     DZrxt4     DZ.corDZ   4       8  0.127322929 0.04506090  
78    DZrxph9     DZ.corDZ   5       8  0.299000496 0.04178691  
79   DZrxph11     DZ.corDZ   6       8  0.372652354 0.03954045  
80   DZrxph12     DZ.corDZ   7       8  0.569603951 0.03120643  

Model Statistics: 
               |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
       Model:             80                   8613               25472.1
   Saturated:             NA                     NA                    NA
Independence:             NA                     NA                    NA
Number of observations/statistics: 1116/8693

Information Criteria: 
      |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
AIC:       8246.101                25632.1                 25644.62
BIC:     -34969.679                26033.5                 25779.40
CFI: NA 
TLI: 1   (also known as NNFI) 
RMSEA:  0  [95% CI (NA, NA)]
Prob(RMSEA &lt;= 0.05): NA
To get additional fit indices, see help(mxRefModels)
timestamp: 2022-10-03 14:20:03 
Wall clock time: 1.821624 secs 
optimizer:  SLSQP 
OpenMx version number: 2.20.3 
Need help?  See help(mxSummary) </code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to saturated</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mxCompare</span>(SatFit, sub4Fit)</span></code></pre></div>
<pre><code>  base comparison ep minus2LL   df      AIC   diffLL diffdf          p
1  Sat       &lt;NA&gt; 88 25456.57 8605 25632.57       NA     NA         NA
2  Sat       sub4 80 25472.10 8613 25632.10 15.53269      8 0.04957862</code></pre>
<p>This p value would round to p = 0.05 so I would interpret this as not significant. This suggests there are equal means across twin order (elder and younger variables).</p>
</div>
<div id="saturated-sub-model-5-equal-means-across-twin-order-and-zygosity" class="section level3">
<h3>Saturated <em>sub-model 5</em>: equal means across twin order and zygosity</h3>
<p>We will run equal variances across twin order and zygosity. The labels for these have already been done in the sub1 model (which constrains everything at once).</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sub4Model <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(SatModel, <span class="at">name =</span> <span class="st">&quot;sub4&quot;</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>sub4Model <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(sub4Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> labMZm, <span class="at">newlabels =</span> sub1labm)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>sub4Model <span class="ot">&lt;-</span> <span class="fu">omxSetParameters</span>(sub4Model, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> labDZm, <span class="at">newlabels =</span> sub1labm)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>sub4Fit <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(sub4Model, <span class="at">intervals =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>(sub4Summ   <span class="ot">&lt;-</span> <span class="fu">summary</span>(sub4Fit))</span></code></pre></div>
<pre><code>Summary of sub4 
 
free parameters:
         name       matrix row     col    Estimate  Std.Error A
1          m5 MZ.ExpMeanMZ   1  sisoe5 0.806677231 0.02735347  
2          m7 MZ.ExpMeanMZ   1  sisoe7 0.807833311 0.02848294  
3         m10 MZ.ExpMeanMZ   1 sisoe10 0.920378577 0.03182558  
4         m12 MZ.ExpMeanMZ   1 sisoe12 0.931288224 0.03356044  
5      MZsde5      MZ.sdMZ   1       1 1.156770168 0.03284015  
6      MZsde7      MZ.sdMZ   2       2 1.091943879 0.03136624  
7     MZsde10      MZ.sdMZ   3       3 1.294556255 0.03747310  
8     MZsde12      MZ.sdMZ   4       4 1.327333812 0.03833753  
9      MZsdy5      MZ.sdMZ   5       5 0.966553030 0.02760741  
10     MZsdy7      MZ.sdMZ   6       6 1.014059560 0.02932609  
11    MZsdy10      MZ.sdMZ   7       7 1.128912792 0.03298278  
12    MZsdy12      MZ.sdMZ   8       8 1.308693970 0.03790600  
13    MZrxph1     MZ.corMZ   1       2 0.475397348 0.03150063  
14    MZrxph2     MZ.corMZ   1       3 0.320099901 0.03684241  
15    MZrxph4     MZ.corMZ   2       3 0.430302995 0.03328398  
16    MZrxph3     MZ.corMZ   1       4 0.250599936 0.03845670  
17    MZrxph5     MZ.corMZ   2       4 0.348026200 0.03584522  
18    MZrxph6     MZ.corMZ   3       4 0.527053843 0.02963245  
19     MZrxt1     MZ.corMZ   1       5 0.579106887 0.02670612  
20  MZrxtxph4     MZ.corMZ   2       5 0.287290502 0.03743509  
21  MZrxtxph7     MZ.corMZ   3       5 0.232005623 0.03885631  
22 MZrxtxph10     MZ.corMZ   4       5 0.202481947 0.03903006  
23  MZrxtxph1     MZ.corMZ   1       6 0.341979609 0.03598655  
24     MZrxt2     MZ.corMZ   2       6 0.437399883 0.03295692  
25  MZrxtxph8     MZ.corMZ   3       6 0.376949801 0.03552802  
26 MZrxtxph11     MZ.corMZ   4       6 0.272527432 0.03812428  
27    MZrxph7     MZ.corMZ   5       6 0.541457872 0.02888694  
28  MZrxtxph2     MZ.corMZ   1       7 0.283613839 0.03781768  
29  MZrxtxph5     MZ.corMZ   2       7 0.246624631 0.03838072  
30     MZrxt3     MZ.corMZ   3       7 0.451288478 0.03274345  
31 MZrxtxph12     MZ.corMZ   4       7 0.333449194 0.03657815  
32    MZrxph8     MZ.corMZ   5       7 0.360250542 0.03584809  
33   MZrxph10     MZ.corMZ   6       7 0.443216945 0.03324906  
34  MZrxtxph3     MZ.corMZ   1       8 0.281082355 0.03779136  
35  MZrxtxph6     MZ.corMZ   2       8 0.235150492 0.03889740  
36  MZrxtxph9     MZ.corMZ   3       8 0.378022927 0.03556083  
37     MZrxt4     MZ.corMZ   4       8 0.428871630 0.03338803  
38    MZrxph9     MZ.corMZ   5       8 0.343650994 0.03593934  
39   MZrxph11     MZ.corMZ   6       8 0.423816499 0.03409412  
40   MZrxph12     MZ.corMZ   7       8 0.536325871 0.02968870  
41     DZsde5      DZ.sdDZ   1       1 1.165624615 0.03710804  
42     DZsde7      DZ.sdDZ   2       2 1.440630059 0.04637314  
43    DZsde10      DZ.sdDZ   3       3 1.487441808 0.04805287  
44    DZsde12      DZ.sdDZ   4       4 1.514303520 0.04910487  
45     DZsdy5      DZ.sdDZ   5       5 1.259385948 0.04012502  
46     DZsdy7      DZ.sdDZ   6       6 1.174099059 0.03783885  
47    DZsdy10      DZ.sdDZ   7       7 1.290566212 0.04159936  
48    DZsdy12      DZ.sdDZ   8       8 1.358995550 0.04421278  
49    DZrxph1     DZ.corDZ   1       2 0.538663771 0.03221293  
50    DZrxph2     DZ.corDZ   1       3 0.414776082 0.03765606  
51    DZrxph4     DZ.corDZ   2       3 0.585890564 0.03044331  
52    DZrxph3     DZ.corDZ   1       4 0.378579849 0.03892779  
53    DZrxph5     DZ.corDZ   2       4 0.475803924 0.03649818  
54    DZrxph6     DZ.corDZ   3       4 0.665640366 0.02560082  
55     DZrxt1     DZ.corDZ   1       5 0.064261930 0.04493311  
56  DZrxtxph4     DZ.corDZ   2       5 0.067778474 0.04537960  
57  DZrxtxph7     DZ.corDZ   3       5 0.066929991 0.04565700  
58 DZrxtxph10     DZ.corDZ   4       5 0.003047219 0.04591128  
59  DZrxtxph1     DZ.corDZ   1       6 0.141131999 0.04430160  
60     DZrxt2     DZ.corDZ   2       6 0.206986223 0.04364468  
61  DZrxtxph8     DZ.corDZ   3       6 0.142650629 0.04515970  
62 DZrxtxph11     DZ.corDZ   4       6 0.117590324 0.04608599  
63    DZrxph7     DZ.corDZ   5       6 0.427903485 0.03728991  
64  DZrxtxph2     DZ.corDZ   1       7 0.109227211 0.04482454  
65  DZrxtxph5     DZ.corDZ   2       7 0.157186588 0.04460673  
66     DZrxt3     DZ.corDZ   3       7 0.191505036 0.04399820  
67 DZrxtxph12     DZ.corDZ   4       7 0.101154855 0.04561550  
68    DZrxph8     DZ.corDZ   5       7 0.349540912 0.04033892  
69   DZrxph10     DZ.corDZ   6       7 0.482921419 0.03504695  
70  DZrxtxph3     DZ.corDZ   1       8 0.156021978 0.04431033  
71  DZrxtxph6     DZ.corDZ   2       8 0.124925405 0.04551924  
72  DZrxtxph9     DZ.corDZ   3       8 0.170115110 0.04445554  
73     DZrxt4     DZ.corDZ   4       8 0.133730899 0.04511195  
74    DZrxph9     DZ.corDZ   5       8 0.302957972 0.04171743  
75   DZrxph11     DZ.corDZ   6       8 0.374619722 0.03949094  
76   DZrxph12     DZ.corDZ   7       8 0.569274268 0.03119786  

Model Statistics: 
               |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
       Model:             76                   8617              25490.28
   Saturated:             NA                     NA                    NA
Independence:             NA                     NA                    NA
Number of observations/statistics: 1116/8693

Information Criteria: 
      |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
AIC:       8256.283               25642.28                 25653.55
BIC:     -34979.567               26023.61                 25782.22
CFI: NA 
TLI: 1   (also known as NNFI) 
RMSEA:  0  [95% CI (NA, NA)]
Prob(RMSEA &lt;= 0.05): NA
To get additional fit indices, see help(mxRefModels)
timestamp: 2022-10-03 14:20:05 
Wall clock time: 1.604541 secs 
optimizer:  SLSQP 
OpenMx version number: 2.20.3 
Need help?  See help(mxSummary) </code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare to saturated</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mxCompare</span>(SatFit, sub4Fit)</span></code></pre></div>
<pre><code>  base comparison ep minus2LL   df      AIC  diffLL diffdf            p
1  Sat       &lt;NA&gt; 88 25456.57 8605 25632.57      NA     NA           NA
2  Sat       sub4 76 25490.28 8617 25642.28 33.7144     12 0.0007481347</code></pre>
<p>This is significant, which suggests that although the means are equal across twin order, they are not equal across twin order and zygosity.</p>
</div>
</div>
<div id="ace-model" class="section level2">
<h2>ACE model</h2>
<div id="matrices-to-estimate-a-c-and-e-path-coefficients" class="section level4">
<h4>Matrices to estimate a, c, and e path coefficients</h4>
<p>The structure of the matrix we need for the Cholesky decomposition, is one where the first latent A, C and E factors (A1, C1 and E1) influence both variables, but the second factors (A2, C2 and E2) only influence the second variable. The matrix type that represents a factor loading I have just described, is type ‘Lower’. As you can see below, the factor loadings a11 and a21 and a22 follow a pattern where the matrix has the diagonal and lower elements, but the upper diagonal element is zero.</p>
<p><strong>Matrices are always (row, column)</strong></p>
<p>Here we have 4 variables (social isolation at ages 5, 7, 10, 12), so this will be a 4x4 matrix: A1 A2 A3 A4 Isolation age 5 Twin 1 a11 0 0 0 # genetic influence on time point 1 Isolation age 7 Twin 1 a21 a22 0 0 # genetic influence on time point 2 (a21) plus new genetic influence at time point 2 (a22) Isolation age 10 Twin 1 a31 a23 a33 0 Isolation age 12 Twin 1 a41 a23 a34 a44</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>pathA   <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Lower&quot;</span>, <span class="at">nrow =</span> nv, <span class="at">ncol =</span> nv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">10</span>)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;a11&quot;</span>, <span class="st">&quot;a21&quot;</span>,<span class="st">&quot;a31&quot;</span>,<span class="st">&quot;a41&quot;</span>,<span class="st">&quot;a22&quot;</span>,<span class="st">&quot;a23&quot;</span>,<span class="st">&quot;a24&quot;</span>,<span class="st">&quot;a33&quot;</span>,<span class="st">&quot;a34&quot;</span>,<span class="st">&quot;a44&quot;</span>), <span class="at">name =</span> <span class="st">&quot;a&quot;</span>) </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>pathC   <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Lower&quot;</span>, <span class="at">nrow =</span> nv, <span class="at">ncol =</span> nv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">10</span>)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;c11&quot;</span>, <span class="st">&quot;c21&quot;</span>,<span class="st">&quot;c31&quot;</span>,<span class="st">&quot;c41&quot;</span>,<span class="st">&quot;c22&quot;</span>,<span class="st">&quot;c23&quot;</span>,<span class="st">&quot;c24&quot;</span>,<span class="st">&quot;c33&quot;</span>,<span class="st">&quot;c34&quot;</span>,<span class="st">&quot;c44&quot;</span>), <span class="at">name =</span> <span class="st">&quot;c&quot;</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>pathE   <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Lower&quot;</span>, <span class="at">nrow =</span> nv, <span class="at">ncol =</span> nv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.5</span>, <span class="dv">10</span>)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;e11&quot;</span>, <span class="st">&quot;e21&quot;</span>,<span class="st">&quot;e31&quot;</span>,<span class="st">&quot;e41&quot;</span>,<span class="st">&quot;e22&quot;</span>,<span class="st">&quot;e23&quot;</span>,<span class="st">&quot;e24&quot;</span>,<span class="st">&quot;e33&quot;</span>,<span class="st">&quot;e34&quot;</span>,<span class="st">&quot;e44&quot;</span>), <span class="at">name =</span> <span class="st">&quot;e&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>MeanG   <span class="ot">&lt;-</span><span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Full&quot;</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> ntv, <span class="at">free =</span> <span class="cn">TRUE</span>, <span class="at">values =</span> svM, <span class="at">labels =</span> sub1labm, <span class="at">name =</span> <span class="st">&quot;ExpMean&quot;</span>)</span></code></pre></div>
<p>Compute the covariance matrix (V) which is the sum of the ACE variance components. Using row-by-col multiplication of a and a transpose, we get the 4x4 A variance covariance matrix of the four variables. We do this multiplication for c and e as well to get the C and E Var/Cov matrix. We can then standardise them to get h2, c2, and e2.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-standardized variance components</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>covA    <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> a <span class="sc">%*%</span> <span class="fu">t</span>(a), <span class="at">name =</span> <span class="st">&quot;A&quot;</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>covC    <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> c <span class="sc">%*%</span> <span class="fu">t</span>(c), <span class="at">name =</span> <span class="st">&quot;C&quot;</span>) </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>covE    <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> e <span class="sc">%*%</span> <span class="fu">t</span>(e), <span class="at">name =</span> <span class="st">&quot;E&quot;</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardized variance components</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>covP <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> A <span class="sc">+</span> C <span class="sc">+</span> E, <span class="at">name =</span> <span class="st">&quot;V&quot;</span> ) <span class="co"># total variance in the phenotype</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>StA <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> A<span class="sc">/</span>V, <span class="at">name =</span> <span class="st">&quot;h2&quot;</span>)         <span class="co"># proportion of variance explained by additive genetic factors</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>StC <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> C<span class="sc">/</span>V, <span class="at">name =</span> <span class="st">&quot;c2&quot;</span>)         <span class="co"># proportion of variance explained by shared environment</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>StE <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> E<span class="sc">/</span>V, <span class="at">name =</span> <span class="st">&quot;e2&quot;</span>)         <span class="co"># proportion of variance explained by unique environment</span></span></code></pre></div>
<p>Below we use the genetic Var/Cov matrix A to get the genetic correlation matrix with rA21 indicating the correlation between the A1 and A2 factors in the Bivariate model. When running an AE model, make sure to had out the Rc.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>matI <span class="ot">&lt;-</span> <span class="fu">mxMatrix</span>(<span class="at">type =</span> <span class="st">&quot;Iden&quot;</span>, <span class="at">nrow =</span> nv, <span class="at">ncol =</span> nv, <span class="at">name =</span> <span class="st">&quot;I&quot;</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>matIsd <span class="ot">&lt;-</span><span class="fu">mxAlgebra</span>(<span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>V)), <span class="at">name =</span> <span class="st">&quot;isd&quot;</span>) <span class="co"># extracting the variances from the diagonal of the covariance matrix V </span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>rph <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>V)) <span class="sc">%*%</span> V <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>V)), <span class="at">name =</span> <span class="st">&quot;Rph&quot;</span>) <span class="co"># new identity matrix for standardising </span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>rA  <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>A)) <span class="sc">%*%</span> A <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>A)), <span class="at">name =</span> <span class="st">&quot;Ra&quot;</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>rC  <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>C)) <span class="sc">%*%</span> C <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>C)), <span class="at">name =</span> <span class="st">&quot;Rc&quot;</span>) <span class="co"># Hash this when running AE model</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>rE  <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>E)) <span class="sc">%*%</span> E <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">sqrt</span>(I<span class="sc">*</span>E)), <span class="at">name =</span> <span class="st">&quot;Re&quot;</span>)</span></code></pre></div>
<p>As well as the correlations between the A, C, and E factors, the below computes the Cholesky parameters.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># path estimates</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>Sta <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(isd<span class="sc">%*%</span>a, <span class="at">name =</span> <span class="st">&quot;sta&quot;</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>Stc <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(isd<span class="sc">%*%</span>c, <span class="at">name =</span> <span class="st">&quot;stc&quot;</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>Ste <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(isd<span class="sc">%*%</span>e, <span class="at">name =</span> <span class="st">&quot;ste&quot;</span>)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co"># path estimates squared</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>Sta2 <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(sta<span class="sc">*</span>sta, <span class="at">name =</span> <span class="st">&quot;sta2&quot;</span>)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>Stc2 <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(stc<span class="sc">*</span>stc, <span class="at">name =</span> <span class="st">&quot;stc2&quot;</span>)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>Ste2 <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(ste<span class="sc">*</span>ste, <span class="at">name =</span> <span class="st">&quot;ste2&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rowVars <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&#39;Vars&#39;</span>, nv)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>colVars <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;h2&#39;</span>, <span class="st">&#39;c2&#39;</span>, <span class="st">&#39;e2&#39;</span>), <span class="at">each =</span> nv)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>estVars <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> <span class="fu">cbind</span>(h2,c2,e2), <span class="at">name =</span> <span class="st">&quot;Est&quot;</span>, <span class="at">dimnames =</span> <span class="fu">list</span>(rowVars,colVars))</span></code></pre></div>
<p>If you want to work out the amount of the phenotypic correlation that is due to A, C or E, you can use the below:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>rphace <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> <span class="fu">cbind</span>((<span class="fu">sqrt</span>(h2[<span class="dv">1</span>,<span class="dv">1</span>])<span class="sc">*</span>Ra[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">sqrt</span>(h2[<span class="dv">2</span>,<span class="dv">2</span>])),</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                            (<span class="fu">sqrt</span>(c2[<span class="dv">1</span>,<span class="dv">1</span>])<span class="sc">*</span>Rc[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">sqrt</span>(c2[<span class="dv">2</span>,<span class="dv">2</span>])),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                            (<span class="fu">sqrt</span>(e2[<span class="dv">1</span>,<span class="dv">1</span>])<span class="sc">*</span>Re[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">sqrt</span>(e2[<span class="dv">2</span>,<span class="dv">2</span>])) ), <span class="at">name =</span> <span class="st">&quot;RphACE&quot;</span> )</span></code></pre></div>
<p>The A factors are correlated across twins either by 1 for MZ pairs or 0.5 for DZ pairs, whereas the C factors are correlated 1 for either type of pairs. For the bivariate + model we have to correlate both the A1 and A2 factors across twins and both the C1 and C2 factors across twins.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>covMZ   <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(A<span class="sc">+</span>C<span class="sc">+</span>E, A<span class="sc">+</span>C),</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cbind</span>(A<span class="sc">+</span>C, A<span class="sc">+</span>C<span class="sc">+</span>E)), <span class="at">name =</span> <span class="st">&quot;expCovMZ&quot;</span> )</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>covDZ   <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> <span class="fu">rbind</span>(<span class="fu">cbind</span>(A<span class="sc">+</span>C<span class="sc">+</span>E, <span class="fl">0.5</span><span class="sc">%x%</span>A<span class="sc">+</span>C),</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">cbind</span>(<span class="fl">0.5</span><span class="sc">%x%</span>A<span class="sc">+</span>C, A<span class="sc">+</span>C<span class="sc">+</span>E)), <span class="at">name =</span> <span class="st">&quot;expCovDZ&quot;</span> )</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data objects </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>dataMZ <span class="ot">&lt;-</span> <span class="fu">mxData</span>(<span class="at">observed =</span> dat.twin.MZ, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>dataDZ <span class="ot">&lt;-</span> <span class="fu">mxData</span>(<span class="at">observed =</span> dat.twin.DZ, <span class="at">type =</span> <span class="st">&quot;raw&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tim uses mxFIMLObjective() here</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>objMZ   <span class="ot">&lt;-</span> <span class="fu">mxExpectationNormal</span>(<span class="at">covariance =</span> <span class="st">&quot;expCovMZ&quot;</span>, <span class="at">means =</span> <span class="st">&quot;ExpMean&quot;</span>, <span class="at">dimnames =</span> selvars)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>objDZ   <span class="ot">&lt;-</span> <span class="fu">mxExpectationNormal</span>(<span class="at">covariance =</span> <span class="st">&quot;expCovDZ&quot;</span>, <span class="at">means =</span> <span class="st">&quot;ExpMean&quot;</span>, <span class="at">dimnames =</span> selvars)</span></code></pre></div>
<hr />
<p>Need to correctly specify the confidence intervals by mapping out which correlation is which in the matrix. ***</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all parameters to be estimated </span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">&lt;-</span> <span class="fu">list</span>(pathA, pathC, pathE, covA, covC, covE, covP, StA, StC, StE, matI, rph, rA, rE, MeanG, estVars, matIsd, Sta, Sta2, Stc, Stc2, Ste, Ste2)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># add these to the model for MZ and DZ with the matrices we have created</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>modelMZ <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(pars, covMZ, dataMZ, objMZ, fitFunction, <span class="at">name =</span> <span class="st">&quot;MZ&quot;</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>modelDZ <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(pars, covDZ, dataDZ, objDZ, fitFunction, <span class="at">name =</span> <span class="st">&quot;DZ&quot;</span>)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>minus2ll <span class="ot">&lt;-</span> <span class="fu">mxAlgebra</span>(<span class="at">expression =</span> MZ.objective <span class="sc">+</span> DZ.objective, <span class="at">name =</span> <span class="st">&quot;m2LL&quot;</span>)</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>obj <span class="ot">&lt;-</span> <span class="fu">mxFitFunctionAlgebra</span>(<span class="st">&quot;m2LL&quot;</span>)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a><span class="co"># confidence intervals - not sure if this is the right adaptation for 4 variable model</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>Conf1 <span class="ot">&lt;-</span> <span class="fu">mxCI</span>(<span class="fu">c</span>(<span class="st">&#39;h2[1,1]&#39;</span>, <span class="st">&#39;h2[2,2]&#39;</span>,<span class="st">&#39;h2[3,3]&#39;</span>, <span class="st">&#39;h2[4,4]&#39;</span>, <span class="st">&#39;c2[1,1]&#39;</span>, <span class="st">&#39;c2[2,2]&#39;</span>, <span class="st">&#39;c2[3,3]&#39;</span>, <span class="st">&#39;c2[4,4]&#39;</span>, <span class="st">&#39;e2[1,1]&#39;</span>, <span class="st">&#39;e2[2,2]&#39;</span>, <span class="st">&#39;e2[3,3]&#39;</span>, <span class="st">&#39;e2[4,4]&#39;</span>)) <span class="co"># here you can see if you should drop C from the model</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Conf2 &lt;- mxCI(c(&#39;Rph[2,1]&#39;, &#39;Ra[2,1]&#39;, &#39;Rc[2,1]&#39;, &#39;Re[2,1]&#39;)) # not sure how to label these?</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co"># how am I supposed to know what the below need to be?</span></span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Conf3 &lt;- mxCI(c(&#39;sta2[3,2]&#39;, &#39;stc2[3,2]&#39;, &#39;ste2[3,2]&#39;, &#39;sta2[3,1]&#39;, &#39;stc2[3,1]&#39;, &#39;ste2[3,1]&#39;, &#39;sta2[2,1]&#39;, &#39;stc2[2,1]&#39;, &#39;ste2[2,1]&#39;, &#39;sta2[4,2]&#39;, &#39;stc2[4,2]&#39;, &#39;ste2[4,2]&#39;), &#39;sta2[4,1]&#39;, &#39;stc2[4,1]&#39;, &#39;ste2[4,1]&#39;, &#39;sta2[4,3]&#39;, &#39;stc2[4,3]&#39;, &#39;ste2[4,3]&#39;)</span></span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Conf4 &lt;- mxCI(c(&#39;sta2[1,1]&#39;, &#39;stc2[1,1]&#39;, &#39;ste2[1,1]&#39;, &#39;sta2[2,2]&#39;, &#39;stc2[2,2]&#39;, &#39;ste2[2,2]&#39;, &#39;sta2[3,3]&#39;, &#39;stc2[3,3]&#39;, &#39;ste2[3,3]&#39;, &#39;sta2[4,4]&#39;, &#39;stc2[4,4]&#39;, &#39;ste2[4,4]&#39;))</span></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Conf5 &lt;- mxCI(c(&#39;h2&#39;, &#39;c2&#39;, &#39;e2&#39;))</span></span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co"># full model</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>AceModel <span class="ot">&lt;-</span> <span class="fu">mxModel</span>(<span class="st">&quot;ACE&quot;</span>, pars, modelMZ, modelDZ, minus2ll, obj, </span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>                    Conf1 </span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Conf3</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>                    )</span></code></pre></div>
<p><em>I still don’t understand here why you estimate the correlated factors solution as well as the choesky paths?</em></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run ACE</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>AceFit <span class="ot">&lt;-</span> <span class="fu">mxRun</span>(AceModel, <span class="at">intervals =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># summary - this shows the position in the cells for each matrix </span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>AceSumm <span class="ot">&lt;-</span> <span class="fu">summary</span>(AceFit)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>AceSumm</span></code></pre></div>
<pre><code>Summary of ACE 
 
free parameters:
   name  matrix row col      Estimate  Std.Error A
1   a11       a   1   1  8.643569e-01 0.03171936  
2   a21       a   2   1  5.267595e-01 0.04285239  
3   a31       a   3   1  5.098095e-01 0.04826886  
4   a41       a   4   1  5.121426e-01 0.05045538  
5   a22       a   2   2  6.532339e-01 0.03700672  
6   a23       a   3   2  4.864147e-01 0.07191173  
7   a24       a   4   2  3.501336e-01 0.06231968  
8   a33       a   3   3  5.881180e-01 0.09480751  
9   a34       a   4   3  4.999926e-01 0.12083102  
10  a44       a   4   4  4.744896e-01 0.12719094 !
11  c11       c   1   1 -3.876873e-03 0.09368327 !
12  c21       c   2   1 -3.205065e-02 0.23479315 !
13  c31       c   3   1  6.002703e-02 0.37047587 !
14  c41       c   4   1 -3.598797e-02 0.26217032 !
15  c22       c   2   2 -3.557430e-05 0.66834051 !
16  c23       c   3   2  6.248538e-05 1.41473573  
17  c24       c   4   2 -3.004676e-05 0.82775693 !
18  c33       c   3   3  2.904601e-06 0.35358357  
19  c34       c   4   3 -2.084908e-06 0.21460964  
20  c44       c   4   4  5.847025e-06 0.19174356 !
21  e11       e   1   1  7.614034e-01 0.02260273  
22  e21       e   2   1  3.018304e-01 0.03415487  
23  e31       e   3   1  1.569588e-01 0.03833150  
24  e41       e   4   1  1.060054e-01 0.04143494  
25  e22       e   2   2  7.902905e-01 0.02278362  
26  e23       e   3   2  1.981296e-01 0.03715302  
27  e24       e   4   2  2.035019e-01 0.04070242  
28  e33       e   3   3  9.013999e-01 0.02478941  
29  e34       e   4   3  3.172898e-01 0.03803954  
30  e44       e   4   4  9.529478e-01 0.02494218  
31   m5 ExpMean   1   1  8.229887e-01 0.02909800  
32   m7 ExpMean   1   2  8.418711e-01 0.02981478  
33  m10 ExpMean   1   3  9.500144e-01 0.03295644  
34  m12 ExpMean   1   4  9.520727e-01 0.03442141  

confidence intervals:
                  lbound     estimate     ubound note
ACE.h2[1,1] 5.025935e-01 5.630671e-01 0.61701272     
ACE.h2[2,2] 3.946656e-01 4.956021e-01 0.55531809     
ACE.h2[3,3] 3.724089e-01 4.890767e-01 0.54842245     
ACE.h2[4,4] 3.529860e-01 4.472860e-01 0.50733896     
ACE.c2[1,1] 1.410027e-12 1.132758e-05 0.02405974     
ACE.c2[2,2] 8.733288e-23 7.229651e-04 0.07038687     
ACE.c2[3,3] 1.997816e-24 2.091987e-03 0.08918121     
ACE.c2[4,4] 2.651825e-21 6.735865e-04 0.06511318     
ACE.e2[1,1] 3.829817e-01 4.369216e-01 0.49726899     
ACE.e2[2,2] 4.446682e-01 5.036750e-01 0.56898588     
ACE.e2[3,3] 4.515731e-01 5.088313e-01 0.57207752     
ACE.e2[4,4] 4.926267e-01 5.520404e-01 0.61618328     

Model Statistics: 
               |  Parameters  |  Degrees of Freedom  |  Fit (-2lnL units)
       Model:             34                   8659              25756.35
   Saturated:             NA                     NA                    NA
Independence:             NA                     NA                    NA
Number of observations/statistics: 1116/8693

Information Criteria: 
      |  df Penalty  |  Parameters Penalty  |  Sample-Size Adjusted
AIC:       8438.346               25824.35                 25826.55
BIC:     -35008.239               25994.94                 25886.95
CFI: NA 
TLI: 1   (also known as NNFI) 
RMSEA:  0  [95% CI (NA, NA)]
Prob(RMSEA &lt;= 0.05): NA
To get additional fit indices, see help(mxRefModels)
timestamp: 2022-10-03 14:20:12 
Wall clock time: 6.322368 secs 
optimizer:  SLSQP 
OpenMx version number: 2.20.3 
Need help?  See help(mxSummary) </code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># full list of A, C, and E estimates - these two outputs show different things - why is that?</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(AceFit<span class="sc">@</span>output<span class="sc">$</span>estimate, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>   a11    a21    a31    a41    a22    a23    a24    a33    a34    a44    c11 
 0.864  0.527  0.510  0.512  0.653  0.486  0.350  0.588  0.500  0.474 -0.004 
   c21    c31    c41    c22    c23    c24    c33    c34    c44    e11    e21 
-0.032  0.060 -0.036  0.000  0.000  0.000  0.000  0.000  0.000  0.761  0.302 
   e31    e41    e22    e23    e24    e33    e34    e44     m5     m7    m10 
 0.157  0.106  0.790  0.198  0.204  0.901  0.317  0.953  0.823  0.842  0.950 
   m12 
 0.952 </code></pre>
</div>
<div id="ace-output" class="section level3">
<h3>ACE output</h3>
<div id="estimates-of-a-c-and-e-for-each-time-point" class="section level4">
<h4>Estimates of A, C, and E, for each time point</h4>
<p>First we have the h<sup>2</sup>, c<sup>2</sup>, and e<sup>2</sup> matrices. This is the proportion of individual differences explained by A, C, and E for each phenotype, so you can view these as percentages.</p>
<p>These matrices are set up like this:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>age 5</th>
<th>age 7</th>
<th>age 10</th>
<th>age 12</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Isolation age 5</td>
<td>a11</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>Isolation age 7</td>
<td>a21</td>
<td>a22</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>Isolation age 10</td>
<td>a31</td>
<td>a23</td>
<td>a33</td>
<td>0</td>
</tr>
<tr class="even">
<td>Isolation age 12</td>
<td>a41</td>
<td>a23</td>
<td>a34</td>
<td>a44</td>
</tr>
</tbody>
</table>
<p>For the h2 matrix:</p>
<ul>
<li>Heritability is on the diagonal</li>
<li>% of the phenotypic correlation that is due to genetics is on the off-diagonal</li>
<li>The bivariate A, C, and E are on the off-diagonal</li>
<li>Therefore, the off-diagonals are the contribution of ACE to the covariance between each time point <strong>need to check this is right</strong></li>
</ul>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All h2, c2, e2 in one matrix </span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(AceFit<span class="sc">$</span>Est<span class="sc">@</span>result, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>        h2    h2    h2    h2 c2     c2     c2     c2    e2    e2    e2    e2
Vars 0.563 0.664 0.787 0.846  0  0.000  0.000  0.000 0.437 0.335 0.213 0.154
Vars 0.664 0.496 0.744 0.720  0  0.001 -0.002  0.002 0.335 0.504 0.259 0.278
Vars 0.787 0.744 0.489 0.680  0 -0.002  0.002 -0.002 0.213 0.259 0.509 0.322
Vars 0.846 0.720 0.680 0.447  0  0.002 -0.002  0.001 0.154 0.278 0.322 0.552</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># h2 </span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mxEval</span>(ACE.h2, AceFit), <span class="dv">3</span>) </span></code></pre></div>
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] 0.563 0.664 0.787 0.846
[2,] 0.664 0.496 0.744 0.720
[3,] 0.787 0.744 0.489 0.680
[4,] 0.846 0.720 0.680 0.447</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># c2</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mxEval</span>(ACE.c2, AceFit), <span class="dv">3</span>) </span></code></pre></div>
<pre><code>     [,1]   [,2]   [,3]   [,4]
[1,]    0  0.000  0.000  0.000
[2,]    0  0.001 -0.002  0.002
[3,]    0 -0.002  0.002 -0.002
[4,]    0  0.002 -0.002  0.001</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># e2</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mxEval</span>(ACE.e2, AceFit), <span class="dv">3</span>) </span></code></pre></div>
<pre><code>      [,1]  [,2]  [,3]  [,4]
[1,] 0.437 0.335 0.213 0.154
[2,] 0.335 0.504 0.259 0.278
[3,] 0.213 0.259 0.509 0.322
[4,] 0.154 0.278 0.322 0.552</code></pre>
<p><strong>Estimates of full ACE model at each time point (diagonal estimates):</strong></p>
<pre><code>                    |  Heritability  | Shared environment | Individual environment |</code></pre>
<p>———————– | ————– | —————— | ———————- | Social isolation age 5 | 0.563 | 0 | 0.437 | Social isolation age 7 | 0.496 | 0.001 | 0.504 | Social isolation age 10 | 0.489 | 0.002 | 0.509 | Social isolation age 12 | 0.447 | 0.001 | 0.552 |</p>
<ul>
<li>The C estimates here are all almost 0, this will probably mean that an AE model will be the best fit</li>
</ul>
<p><strong>Shared effect estimates for ACE across time (off-diagonal estimates):</strong></p>
<ul>
<li>The % of the total variance that is due to shared genetic and environmental effects</li>
</ul>
<table>
<thead>
<tr class="header">
<th></th>
<th>% Shared genetic effects</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Age 5 and 7</td>
<td>66% (0.664)</td>
</tr>
<tr class="even">
<td>Age 5 and 10</td>
<td>79% (0.787)</td>
</tr>
<tr class="odd">
<td>Age 5 and 12</td>
<td>85% (0.846)</td>
</tr>
<tr class="even">
<td>Age 7 and 10</td>
<td>74% (0.744)</td>
</tr>
<tr class="odd">
<td>Age 7 and 12</td>
<td>72% (0.720)</td>
</tr>
<tr class="even">
<td>Age 10 and 12</td>
<td>68% (0.680)</td>
</tr>
</tbody>
</table>
</div>
<div id="correlations-between-a-c-and-e-factors-across-all-time-points" class="section level4">
<h4>Correlations between A, C, and E factors across all time points</h4>
<ul>
<li>Ra = the correlation between A1, A2, A3, and A4 - correlations between all the genetic factors</li>
<li>Rc = the correlation between C1, C2, C3, and C4 - correlations between all shared environmental factors</li>
<li>Re = the correlation between E1, E2, E3, and E4 - correlations between all individual environmental factors</li>
</ul>
<p>For example: <img src="Ra.jpg" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between the A, C, and E factors - to what extend is variable one the same as variable two </span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.Rph <span class="co"># total phenotypic correlation (including A, C, and E)</span></span></code></pre></div>
<pre><code>mxAlgebra &#39;Rph&#39; 
$formula:  solve(sqrt(I * V)) %*% V %*% solve(sqrt(I * V)) 
$result:
          [,1]      [,2]      [,3]      [,4]
[1,] 1.0000000 0.4990635 0.3703872 0.3277666
[2,] 0.4990635 1.0000000 0.5039146 0.4189495
[3,] 0.3703872 0.5039146 1.0000000 0.5859169
[4,] 0.3277666 0.4189495 0.5859169 1.0000000
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.Ra  <span class="co"># correlations between the a factors</span></span></code></pre></div>
<pre><code>mxAlgebra &#39;Ra&#39; 
$formula:  solve(sqrt(I * A)) %*% A %*% solve(sqrt(I * A)) 
$result:
          [,1]      [,2]      [,3]      [,4]
[1,] 1.0000000 0.6277221 0.5554588 0.5522522
[2,] 0.6277221 1.0000000 0.7612218 0.6405640
[3,] 0.5554588 0.7612218 1.0000000 0.8523226
[4,] 0.5522522 0.6405640 0.8523226 1.0000000
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.Rc  <span class="co"># correlations between the c factors</span></span></code></pre></div>
<pre><code>NULL</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.Re  <span class="co"># correlations between the e factors</span></span></code></pre></div>
<pre><code>mxAlgebra &#39;Re&#39; 
$formula:  solve(sqrt(I * E)) %*% E %*% solve(sqrt(I * E)) 
$result:
          [,1]      [,2]      [,3]      [,4]
[1,] 1.0000000 0.3567873 0.1676607 0.1028921
[2,] 0.3567873 1.0000000 0.2575290 0.2212357
[3,] 0.1676607 0.2575290 1.0000000 0.3555878
[4,] 0.1028921 0.2212357 0.3555878 1.0000000
dimnames: NULL</code></pre>
<ul>
<li>The Rc estimate here is NULL - I’m assuming this is because the original estimates are 0 so this algebra would not work?</li>
</ul>
</div>
<div id="cholesky-paths" class="section level4">
<h4>Cholesky paths</h4>
<p>Cholesky paths are directed for longitudinal data. A1 directly influences the next time point, and so on.</p>
<p>For example: <img src="sta2.jpg" /> The squared paths can be interpreted as the % of variance explained. This is equivalent to the correlations between factors, but now you are assuming that age 5 came before age 7 etc. You need to square these to interpret them <em>need to add an explanation as to why this is here</em>.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.sta</span></code></pre></div>
<pre><code>mxAlgebra &#39;sta&#39; 
$formula:  isd %*% a 
$result:
          [,1]      [,2]      [,3]      [,4]
[1,] 0.7503780 0.0000000 0.0000000 0.0000000
[2,] 0.4419101 0.5480123 0.0000000 0.0000000
[3,] 0.3884547 0.3706288 0.4481227 0.0000000
[4,] 0.3693432 0.2525068 0.3605810 0.3421889
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.sta2 </span></code></pre></div>
<pre><code>mxAlgebra &#39;sta2&#39; 
$formula:  sta * sta 
$result:
          [,1]       [,2]      [,3]      [,4]
[1,] 0.5630671 0.00000000 0.0000000 0.0000000
[2,] 0.1952846 0.30031749 0.0000000 0.0000000
[3,] 0.1508970 0.13736570 0.2008139 0.0000000
[4,] 0.1364144 0.06375967 0.1300186 0.1170933
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># C</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.stc</span></code></pre></div>
<pre><code>mxAlgebra &#39;stc&#39; 
$formula:  isd %*% c 
$result:
             [,1]          [,2]          [,3]         [,4]
[1,] -0.003365647  0.000000e+00  0.000000e+00 0.000000e+00
[2,] -0.026887994 -2.984406e-05  0.000000e+00 0.000000e+00
[3,]  0.045738224  4.761139e-05  2.213192e-06 0.000000e+00
[4,] -0.025953536 -2.166890e-05 -1.503579e-06 4.216714e-06
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.stc2</span></code></pre></div>
<pre><code>mxAlgebra &#39;stc2&#39; 
$formula:  stc * stc 
$result:
             [,1]         [,2]         [,3]         [,4]
[1,] 1.132758e-05 0.000000e+00 0.000000e+00 0.000000e+00
[2,] 7.229642e-04 8.906681e-10 0.000000e+00 0.000000e+00
[3,] 2.091985e-03 2.266845e-09 4.898217e-12 0.000000e+00
[4,] 6.735861e-04 4.695413e-10 2.260749e-12 1.778068e-11
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># E</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.ste</span></code></pre></div>
<pre><code>mxAlgebra &#39;ste&#39; 
$formula:  isd %*% e 
$result:
           [,1]      [,2]      [,3]      [,4]
[1,] 0.66100045 0.0000000 0.0000000 0.0000000
[2,] 0.25321214 0.6629921 0.0000000 0.0000000
[3,] 0.11959641 0.1509669 0.6868311 0.0000000
[4,] 0.07644821 0.1467600 0.2288207 0.6872399
dimnames: NULL</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>AceFit<span class="sc">$</span>ACE.ste2</span></code></pre></div>
<pre><code>mxAlgebra &#39;ste2&#39; 
$formula:  ste * ste 
$result:
            [,1]       [,2]       [,3]      [,4]
[1,] 0.436921592 0.00000000 0.00000000 0.0000000
[2,] 0.064116385 0.43955859 0.00000000 0.0000000
[3,] 0.014303301 0.02279102 0.47173702 0.0000000
[4,] 0.005844329 0.02153849 0.05235892 0.4722987
dimnames: NULL</code></pre>
</div>
<div id="compare-the-ace-model-fit-to-the-saturated-model-fit" class="section level4">
<h4>Compare the ACE model fit to the saturated model fit</h4>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mxCompare</span>(SatFit, AceFit)</span></code></pre></div>
<pre><code>  base comparison ep minus2LL   df      AIC   diffLL diffdf            p
1  Sat       &lt;NA&gt; 88 25456.57 8605 25632.57       NA     NA           NA
2  Sat        ACE 34 25756.35 8659 25824.35 299.7777     54 8.922749e-36</code></pre>
<p><strong>The ACE model fits significantly worse than the saturated model</strong>. This may be because we are estimating C when this doesn’t actually fit to our data. The next step is to run the AE model.</p>
<hr />
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # create the new model </span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="co"># AEModel   &lt;-mxModel(AceFit, name = &quot;AE&quot; </span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                   # Conf3, Conf4</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                    )</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a><span class="co"># # set the C parameters to 0</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #AEModel  &lt;- omxSetParameters(AEModel, labels = c(&quot;c11&quot;, &quot;c22&quot;, &quot;c33&quot;, &quot;c44&quot;, </span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                 &quot;c21&quot;, &quot;c23&quot;, &quot;c24&quot;, </span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                 &quot;c31&quot;, &quot;c34&quot;, </span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                 &quot;c41&quot;, &quot;c44&quot;), free = FALSE, values = 0) # need to get the right values here</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a><span class="co"># # run the model </span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="co"># AEFit &lt;- mxRun(AEModel, intervals = TRUE)</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="co"># AESumm &lt;- summary(AEFit)</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="co"># AESumm</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a><span class="co"># # estimates</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a><span class="co"># round(AEFit@output$estimate, 4)</span></span></code></pre></div>
<hr />
<p>NEXT STEPS</p>
<ul>
<li>Go through ACE and output - map out each of the matrices to see what each output is telling you - make a table for this and print off to have in the office.</li>
<li>tidy up ACE model and make more notes from GED avout what each bit means - especially for cholesky.</li>
<li>Cholesky matrices is the sta2 output - this is the diagnoal lines in the path tracing.</li>
<li>Run AE model by removing the rC estimation indicated above, and set the parameters to 0 as seen in Tim’s script.</li>
<li>Interpret the AE output</li>
<li>Email monika about getting the script for the overlap section of the paper</li>
<li>Once finished AE model, tidy up the knitted file so that it shows all code but only important output matrices</li>
</ul>
</div>
</div>
</div>
</div>

<!-- Add footer -->

&nbsp;

<hr />

<center>

<img src="kcl_logo.png" 

     width="100" 

     height="75" />

</center>

<br>

<p style="text-align: center;">Work by <a href="https://github.com/knthompson26/">Katherine N Thompson</a></p>

<p style="text-align: center;"><span style="color: #808080;"><em>katherine.n.thompson@kcl.ac.uk</em></span></p>



<!-- Add icon library -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">



<!-- Add font awesome icons -->

<p style="text-align: center;">

    <a href="https://twitter.com/KTNThompson" class="fa fa-twitter"></a>

    <a href="https://github.com/knthompson26/" class="fa fa-github"></a>

</p>



&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
